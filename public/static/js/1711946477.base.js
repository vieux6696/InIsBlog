/* empty css                    */import{_ as e,u as t,n as s,a as l}from"./1711946477.index.js";import{a6 as a,j as n,aj as o,o as c,c as r,a as i,s as m,a2 as u,J as d,F as p,K as f,q as b,a3 as y,y as v,w,g as h,f as g,i as x}from"./1711946477.@vue.js";import"./1711946477.lscache.js";import"./1711946477.crypto-js.js";import"./1711946477.axios.js";import"./1711946477.element-plus.js";import"./1711946477.lodash-es.js";import"./1711946477.@element-plus.js";import"./1711946477.@popperjs.js";import"./1711946477.@ctrl.js";import"./1711946477.dayjs.js";import"./1711946477.async-validator.js";import"./1711946477.memoize-one.js";import"./1711946477.normalize-wheel-es.js";import"./1711946477.@floating-ui.js";import"./1711946477.notyf.js";import"./1711946477.pinia.js";import"./1711946477.vue-router.js";import"./1711946477.lottie-web.js";import"./1711946477.bootstrap.js";import"./1711946477.plyr.js";import"./1711946477.@fancyapps.js";import"./1711946477.highlight.js.js";import"./1711946477.@howdyjs.js";const _={ref:"pointer",id:"pointer"},V={id:"background"},j={ref:"cover",class:"cover",style:{opacity:"1",transition:"all 1.5s ease 0s"}},k={id:"go-to-top",ref:"go-to-top",class:"d-none"},E={class:"flex-center p-0",type:"button"},z=e({__name:"beautify",setup(e){const{ctx:s,proxy:l}=f(),b=Math.round((new Date).getTime()/1e3),y=a({cover:`https://api.inis.cc/api/file/random?name=cure&unix=${b}`});return n((()=>{const e=l.$refs.pointer,s=e.offsetWidth/2,a=(t,l)=>{e.style.transform=`translate(${t-s+1}px, ${(()=>{let e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e})()+l-s+1}px)`};document.querySelector("body").addEventListener("mousemove",(e=>window.requestAnimationFrame((()=>{a(e.clientX,e.clientY)}))));const n=document.querySelector("#loading-box");n&&setTimeout((()=>n.classList.add("loaded")),500);const o=l.$refs.cover;l.$refs["bg-img"],o.style.setProperty("opacity",0),o.style.setProperty("transition","all 1.5s ease 0s"),Boolean(window.navigator.userAgent.match(/AppWebKit.*Mobile.*/))&&(e.style.display="none"),window.onscroll=()=>{let[e,s]=[null,!0],a=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;const n=l.$refs["go-to-top"];n.style.setProperty("display",a>300?"block":"none","important"),n.addEventListener("click",(()=>{s=!0,e=setTimeout((()=>{s&&t.to.scroll(0)}),150)})),n.addEventListener("dblclick",(()=>{clearTimeout(e),s=!1,t.to.scroll(o())}));const o=()=>{let e=0;return e=document.body.clientHeight&&document.documentElement.clientHeight?document.body.clientHeight<document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight:document.body.clientHeight>document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight,Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-e}}})),(e,t)=>{const s=o("el-image"),l=o("i-svg");return c(),r(p,null,[i("div",_,null,512),i("div",V,[m(s,{src:"/assets/imgs/bg.webp",fit:"cover",style:{width:"100%",height:"100%",position:"fixed",left:"0",top:"0"}},{error:u((()=>[m(s,{src:d(y).cover,fit:"cover",style:{width:"100%",height:"100%",position:"fixed",left:"0",top:"0"}},null,8,["src"])])),_:1}),i("div",j,null,512)]),i("div",k,[i("button",E,[m(l,{name:"go-to-top",size:"30px"})])],512)],64)}}},[["__scopeId","data-v-7c278f07"]]),q={id:"footer",class:"text-white user-select-none"},U=i("span",null,[y(" & "),i("a",{href:"https://inis.cc",target:"_blank",class:"text-white"},"INIS 3.0.0")],-1),D=i("span",null,[y(" & "),i("a",{href:"https://inis-api.apifox.cn",target:"_blank",class:"text-white"},"API 文档")],-1),A={__name:"footer",setup(e){const t=(new Date).getFullYear();return(e,s)=>(c(),r("footer",q,[i("span",null,"Copyright © 2020 - "+b(d(t)),1),U,D]))}},H={class:"container-fluid mt-5"},T={class:"card mt-3"},Q={key:0,class:"card-body"},S={class:"row my-2"},B={class:"col-md-6"},C={class:"form-group mb-3"},L={class:"form-label"},Y=i("span",{class:"ms-1"},"类型：",-1),K={class:"font-13"},$={class:"text-muted float-end"},I={class:"col-md-6"},M={class:"form-group mb-3"},P={class:"form-label"},F=i("span",{class:"ms-1"},"字符集：",-1),O={class:"font-13"},R={class:"text-muted float-end"},N={class:"row my-2"},W={class:"col-md-4"},J={class:"form-group mb-3"},X={class:"form-label required"},G=i("span",{class:"ms-1"},"地址：",-1),Z={class:"col-md-4"},ee={class:"form-group mb-3"},te={class:"form-label required"},se=i("span",{class:"ms-1"},"端口号：",-1),le={class:"col-md-4"},ae={class:"form-group mb-3"},ne={class:"form-label required"},oe=i("span",{class:"ms-1"},"表前缀：",-1),ce={class:"row my-2"},re={class:"col-md-4"},ie={class:"form-group mb-3"},me={class:"form-label required"},ue=i("span",{class:"ms-1"},"数据库名：",-1),de={class:"col-md-4"},pe={class:"form-group mb-3"},fe={class:"form-label required"},be=i("span",{class:"ms-1"},"用户名：",-1),ye={class:"col-md-4"},ve={class:"form-group mb-3"},we={class:"form-label required"},he=i("span",{class:"ms-1"},"密码：",-1),ge={class:"d-flex justify-content-center"},xe=i("span",{class:"ms-1"},"测试连接",-1),_e={key:1,class:"card-body"},Ve={class:"row my-2"},je={class:"col-md-4"},ke={class:"form-group mb-3"},Ee={class:"form-label required"},ze=i("span",{class:"ms-1"},"帐号：",-1),qe={class:"col-md-4"},Ue={class:"form-group mb-3"},De={class:"form-label required"},Ae=i("span",{class:"ms-1"},"密码：",-1),He={class:"col-md-4"},Te={class:"form-group mb-3"},Qe={class:"form-label required"},Se=i("span",{class:"ms-1"},"确认密码：",-1),Be={class:"row my-2"},Ce={class:"col-md-6"},Le={class:"form-group mb-3"},Ye={class:"form-label"},Ke=i("span",{class:"ms-1"},"昵称：",-1),$e={class:"col-md-6"},Ie={class:"form-group mb-3"},Me={class:"form-label required"},Pe=i("span",{class:"ms-1"},"邮箱：",-1),Fe={class:"row my-2"},Oe={class:"col-lg-12"},Re={class:"form-group mb-3"},Ne={class:"form-label"},We=i("span",{class:"ms-1"},"个人简介：",-1),Je={class:"d-flex justify-content-center"},Xe={key:2,class:"card-body"},Ge={class:"alert alert-primary pb-0",role:"alert"},Ze=i("h3",{class:"alert-heading"},"恭喜您！",-1),et=i("p",null,"当你看到我的时候，就表示你已经成功的安装 inis 程序，感谢你的使用。",-1),tt=i("span",{class:"mx-2"},"|",-1),st=i("span",{class:"mx-2"},"|",-1),lt=i("span",{class:"mx-2"},"|",-1),at=i("span",{class:"mx-2"},"|",-1),nt=i("hr",null,null,-1),ot={class:"d-flex justify-content-center my-3"},ct={__name:"index",setup(e){const n=a({item:{active:1,DB_KEY:"DATABASE_STRUCT",connect:!1},struct:{type:"mysql",hostname:"localhost",hostport:3306,charset:"utf8mb4",prefix:"inis_",database:"",username:"",password:""},user:{account:null,password1:null,password2:null,nickname:null,email:null,description:"这个人很懒，什么都没有留下！"},select:{db:[{value:"mysql",label:"MySQL 数据库"}],charset:[{value:"utf8mb4",label:"支持4字节的Unicode字符，是MySQL 5.5.3及以上版本推荐使用的默认字符集。"},{value:"utf8",label:"支持3字节的Unicode字符，但无法正确存储一些特殊的Emoji表情符号。"},{value:"gb2312",label:"汉字编码标准。"},{value:"gbk",label:"扩展了gb2312字符集，支持更多汉字。"},{value:"latin1",label:"ISO-8859-1字符集，支持西欧语言。"}]},load:{connect:!1},retry:{count:1,time:2e3}});v((async()=>{t.has.session(n.item.DB_KEY)&&(n.struct=t.get.session(n.item.DB_KEY))}));const f={connect:async()=>{if(t.is.empty(n.struct.hostname))return s.warn("数据库地址不能为空！");if(t.is.empty(n.struct.hostport))return s.warn("数据库端口不能为空！");if(t.is.empty(n.struct.database))return s.warn("数据库名称不能为空！");if(t.is.empty(n.struct.username))return s.warn("数据库用户名不能为空！");if(t.is.empty(n.struct.password))return s.warn("数据库密码不能为空！");n.load.connect=!0;const{code:e,msg:a}=await l.post("/dev/install/connect-db",n.struct);if(n.load.connect=!1,200!==e)return n.item.connect=!1,s.error(a);n.item.connect=!0,s.success("数据库连接成功！"),t.set.session(n.item.DB_KEY,n.struct)},initDB:async()=>{const{code:e,msg:t}=await l.post("/dev/install/init-db");200!==e&&(s.error(t),n.item.connect=!1)},createAdmin:async()=>{if(!n.item.connect)return s.warn("请先测试数据库连接！");if(t.is.empty(n.user.account))return s.warn("帐号不能为空！");if(t.is.empty(n.user.email))return s.warn("邮箱不能为空！");if(!t.is.email(n.user.email))return s.warn("邮箱格式不正确！");if(t.is.empty(n.user.password1))return s.warn("密码不能为空！");if(t.is.empty(n.user.password2))return s.warn("请再次输入密码！");if(n.user.password1!==n.user.password2)return s.warn("两次输入的密码不一致！");n.user.password=n.user.password2;try{const{code:e,msg:a}=await l.post("/dev/install/create-admin",n.user);if(500===e)return f.retry();if(200!==e)return s.error(a);delete n.user.password1,delete n.user.password2,s.success("创建管理员成功！"),t.clear.session(n.item.DB_KEY),await f.lock(),await f.next(3)}catch(e){await f.retry()}},retry:async()=>{if(n.retry.count>5)return s.error("安装失败，请联系兔子，QQ：97783391",{duration:6e5});await f.sleep(n.retry.time),await f.connect(),await f.sleep(n.retry.time),await f.initDB(),await f.sleep(n.retry.time),await f.createAdmin(),n.retry.count++},sleep:(e=1e3)=>new Promise((t=>setTimeout(t,e))),lock:async()=>{const{code:e,msg:t}=await l.post("/dev/install/lock");if(200!==e)return s.error(t)},next:async(e=1)=>{if(2===e){if(!n.item.connect)return s.warn("请先测试数据库连接！");await f.initDB()}n.item.active=e},prev:(e=1)=>{n.item.active=e},window:(e="/",t="_self")=>window.open(e,t),copy:(e=null,l="复制成功！")=>{if(!t.is.empty(e))return t.set.copy.text(e),t.is.empty(l)?void 0:s.info(l)}};return w((()=>n.user),((e={})=>{n.user.account=e.account.replace(/\s+/g,"")}),{deep:!0}),(e,t)=>{const s=o("el-step"),l=o("el-steps"),a=o("i-svg"),v=o("el-tooltip"),w=o("el-option"),_=o("el-select"),V=o("el-input"),j=o("el-button");return c(),r("div",H,[m(l,{active:d(n).item.active,simple:""},{default:u((()=>[m(s,{title:"配置数据库"}),m(s,{title:"创建管理员"}),m(s,{title:"完成"})])),_:1},8,["active"]),i("div",T,[1===d(n).item.active?(c(),r("div",Q,[i("div",S,[i("div",B,[i("div",C,[i("label",L,[m(v,{content:"数据库的类型，目前只支持MySQL",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),Y])])),_:1})]),m(_,{modelValue:d(n).struct.type,"onUpdate:modelValue":t[0]||(t[0]=e=>d(n).struct.type=e),placeholder:"请选择方式",class:"d-block custom font-13"},{default:u((()=>[(c(!0),r(p,null,h(d(n).select.db,(e=>(c(),g(w,{key:e.value,label:e.label,value:e.value},{default:u((()=>[i("span",K,b(e.label),1),i("small",$,b(e.value),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])]),i("div",I,[i("div",M,[i("label",P,[m(v,{content:"推荐用默认的 utf8mb4",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),F])])),_:1})]),m(_,{modelValue:d(n).struct.charset,"onUpdate:modelValue":t[1]||(t[1]=e=>d(n).struct.charset=e),placeholder:"请选择方式",class:"d-block custom font-13"},{default:u((()=>[(c(!0),r(p,null,h(d(n).select.charset,(e=>(c(),g(w,{key:e.value,label:e.value,value:e.value},{default:u((()=>[i("span",O,b(e.value),1),i("small",R,b(e.label),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])]),i("div",N,[i("div",W,[i("div",J,[i("label",X,[m(v,{placement:"top"},{content:u((()=>[y(" （必须）正常来说默认就行，相对于程序所在的服务器来说，如果数据库不在本地，那么就填写数据库所在的服务器地址 ")])),default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),G])])),_:1})]),m(V,{modelValue:d(n).struct.hostname,"onUpdate:modelValue":t[2]||(t[2]=e=>d(n).struct.hostname=e),placeholder:"如：localhost"},null,8,["modelValue"])])]),i("div",Z,[i("div",ee,[i("label",te,[m(v,{content:"（必须）默认端口是：3306，如果修改过端口，请填写正确的端口号",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),se])])),_:1})]),m(V,{modelValue:d(n).struct.hostport,"onUpdate:modelValue":t[3]||(t[3]=e=>d(n).struct.hostport=e)},null,8,["modelValue"])])]),i("div",le,[i("div",ae,[i("label",ne,[m(v,{content:"（必须）数据库表前缀",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),oe])])),_:1})]),m(V,{modelValue:d(n).struct.prefix,"onUpdate:modelValue":t[4]||(t[4]=e=>d(n).struct.prefix=e),disabled:""},null,8,["modelValue"])])])]),i("div",ce,[i("div",re,[i("div",ie,[i("label",me,[m(v,{content:"（必须）数据库的名称",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),ue])])),_:1})]),m(V,{modelValue:d(n).struct.database,"onUpdate:modelValue":t[5]||(t[5]=e=>d(n).struct.database=e)},null,8,["modelValue"])])]),i("div",de,[i("div",pe,[i("label",fe,[m(v,{content:"（必须）数据库用户名称",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),be])])),_:1})]),m(V,{modelValue:d(n).struct.username,"onUpdate:modelValue":t[6]||(t[6]=e=>d(n).struct.username=e)},null,8,["modelValue"])])]),i("div",ye,[i("div",ve,[i("label",we,[m(v,{content:"（必须）数据库的密码",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),he])])),_:1})]),m(V,{modelValue:d(n).struct.password,"onUpdate:modelValue":t[7]||(t[7]=e=>d(n).struct.password=e),"show-password":""},null,8,["modelValue"])])])]),i("div",ge,[m(j,{onClick:t[8]||(t[8]=e=>f.connect()),loading:d(n).load.connect,class:"mx-2"},{default:u((()=>[d(n).item.connect?x("",!0):(c(),g(a,{key:0,name:"connect",size:"14px"})),xe])),_:1},8,["loading"]),m(j,{onClick:t[9]||(t[9]=e=>f.next(2)),type:"primary",class:"mx-2"},{default:u((()=>[y("下一步")])),_:1})])])):2===d(n).item.active?(c(),r("div",_e,[i("div",Ve,[i("div",je,[i("div",ke,[i("label",Ee,[m(v,{placement:"top"},{content:u((()=>[y(" （必须）用来登录的账户，此处默认管理员权限 ")])),default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),ze])])),_:1})]),m(V,{modelValue:d(n).user.account,"onUpdate:modelValue":t[10]||(t[10]=e=>d(n).user.account=e)},null,8,["modelValue"])])]),i("div",qe,[i("div",Ue,[i("label",De,[m(v,{content:"（必须）推荐大于8位，且包含数字、字母和特殊符号",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),Ae])])),_:1})]),m(V,{modelValue:d(n).user.password1,"onUpdate:modelValue":t[11]||(t[11]=e=>d(n).user.password1=e),"show-password":""},null,8,["modelValue"])])]),i("div",He,[i("div",Te,[i("label",Qe,[m(v,{content:"（必须）推荐大于8位，且包含数字、字母和特殊符号",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),Se])])),_:1})]),m(V,{modelValue:d(n).user.password2,"onUpdate:modelValue":t[12]||(t[12]=e=>d(n).user.password2=e),"show-password":""},null,8,["modelValue"])])])]),i("div",Be,[i("div",Ce,[i("div",Le,[i("label",Ye,[m(v,{placement:"top"},{content:u((()=>[y(" 用来显示的昵称 ")])),default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),Ke])])),_:1})]),m(V,{modelValue:d(n).user.nickname,"onUpdate:modelValue":t[13]||(t[13]=e=>d(n).user.nickname=e)},null,8,["modelValue"])])]),i("div",$e,[i("div",Ie,[i("label",Me,[m(v,{content:"（必须）开启短信服务之后，用来登录或找回密码",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),Pe])])),_:1})]),m(V,{modelValue:d(n).user.email,"onUpdate:modelValue":t[14]||(t[14]=e=>d(n).user.email=e)},null,8,["modelValue"])])])]),i("div",Fe,[i("div",Oe,[i("div",Re,[i("label",Ne,[m(v,{content:"简单的介绍一下",placement:"top"},{default:u((()=>[i("span",null,[m(a,{name:"hint",size:"14px"}),We])])),_:1})]),m(V,{modelValue:d(n).user.description,"onUpdate:modelValue":t[15]||(t[15]=e=>d(n).user.description=e),autosize:{minRows:3,maxRows:10},placeholder:"写点什么吧 ...",type:"textarea"},null,8,["modelValue"])])])]),i("div",Je,[m(j,{onClick:t[16]||(t[16]=e=>f.prev(1)),class:"mx-2"},{default:u((()=>[y("上一步")])),_:1}),m(j,{onClick:t[17]||(t[17]=e=>f.createAdmin()),type:"primary",class:"mx-2"},{default:u((()=>[y("下一步")])),_:1})])])):(c(),r("div",Xe,[i("div",Ge,[Ze,et,i("p",null,[y("● "),m(v,{content:"双击复制",placement:"top"},{default:u((()=>[i("span",{onDblclick:t[18]||(t[18]=e=>f.copy(632274746))},"inis官方QQ群：632274746",32)])),_:1}),tt,m(v,{content:"双击复制",placement:"top"},{default:u((()=>[i("span",{onDblclick:t[19]||(t[19]=e=>f.copy(926403239))},"开发者QQ群：926403239",32)])),_:1}),st,m(v,{content:"点我前往",placement:"top"},{default:u((()=>[i("span",{onClick:t[20]||(t[20]=e=>f.window("//inis.cc","_blank"))},"官方社区 inis.cc")])),_:1})]),i("p",null,[y("● "),m(v,{content:"双击复制",placement:"top"},{default:u((()=>[i("span",{onDblclick:t[21]||(t[21]=e=>f.copy(97783391))},"作者QQ：97783391",32)])),_:1}),lt,m(v,{content:"双击复制",placement:"top"},{default:u((()=>[i("span",{onDblclick:t[22]||(t[22]=e=>f.copy("v-inis"))},"作者微信：v-inis",32)])),_:1}),at,m(v,{content:"点我前往",placement:"top"},{default:u((()=>[i("span",{onClick:t[23]||(t[23]=e=>f.window("https://inis-pro.apifox.cn","_blank"))},"API 文档：inis-pro.apifox.cn")])),_:1})]),nt,i("p",ot,[m(j,{onClick:t[24]||(t[24]=e=>f.window()),type:"primary",class:"mx-2"},{default:u((()=>[y("回 到 首 页")])),_:1})])])]))])])}}},rt={__name:"base",setup:e=>(n((()=>{const e=document.querySelector("body");e.setAttribute("data-layout","topnav"),e.setAttribute("inis-theme","white"),e.classList.add("user-select-none");document.querySelector("#app").classList.add("install")})),(e,t)=>(c(),r(p,null,[m(z),m(ct),m(A)],64)))};export{rt as default};
