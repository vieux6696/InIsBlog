import{a as s,n as t}from"./1711946477.index.js";import{a6 as a,y as e,w as l,aj as n,as as o,o as i,c,l as u,J as d,a as r,s as m,a2 as p,a3 as g,F as f}from"./1711946477.@vue.js";const v={class:"card mb-3"},b={class:"card-body"},h={class:"text-muted text-uppercase mt-0"},x=r("strong",{class:"text-success"},"开启后让DDOS和CC等异常流量无懈可击！",-1),w=r("br",null,null,-1),_=r("br",null,null,-1),y={class:"d-inline-flex align-items-center"},S=r("span",{class:"ms-1"},"QPS",-1),V={class:"m-b-20"},k=r("span",{class:"badge bg-primary font-white"}," +90% ",-1),j={class:"text-muted ms-1"},C=r("strong",{class:"flex-center"},"配置",-1),P={class:"row"},I={class:"col-md-6"},E={class:"form-group mb-3"},M={class:"form-label"},T=r("span",{class:"ms-1"},"全局限制：",-1),z={class:"col-md-6"},Q={class:"form-group mb-3"},U={class:"form-label"},Y=r("span",{class:"ms-1"},"单接口限制：",-1),A={__name:"qps",setup(A,{expose:D}){const G=a({struct:{value:0,json:{global:30,point:15}},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});e((async()=>{await L.init()}));const L={init:async()=>{G.status.finish=!1,G.status.loading=!0;const{code:t,data:a}=await s.get("/api/config/one",{key:"SYSTEM_QPS"});G.status.loading=!1,200===t&&(G.struct=a,G.status.finish=!0)},show(){if(!G.status.finish)return t.warn("QPS配置获取失败，无法进行配置！");G.status.dialog=!0},change:async a=>{const{code:e,msg:l}=await s.post("/api/config/save",{key:"SYSTEM_QPS",value:a?1:0});200!==e&&(G.status.active=!a,t.error(l))},save:async()=>{G.status.wait=!0;const{code:a,msg:e}=await s.post("/api/config/save",{key:"SYSTEM_QPS",json:JSON.stringify(G.struct.json)});if(G.status.wait=!1,200!==a)return t.error("保存失败："+e);G.status.dialog=!1}};return l((()=>G.struct),(()=>{G.status.active=1===parseInt(G.struct.value),G.struct.json.global<10&&(G.struct.json.global=10),G.struct.json.point<5&&(G.struct.json.point=5)}),{deep:!0}),D({init:L.init}),(s,t)=>{const a=n("i-svg"),e=n("el-tooltip"),l=n("el-switch"),A=n("el-input-number"),D=n("el-button"),O=n("el-dialog"),q=o("loading");return i(),c(f,null,[u((i(),c("div",v,[r("div",b,[m(a,{name:"qps",size:"60px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),r("h6",h,[m(e,{placement:"top"},{content:p((()=>[x,w,g(" ● QPS俗称限流器，是一种作用于网络层的中间件，主要用于拦截异常流量，如DDOS和CC等"),_,g(" ● QPS会将每个IP的请求次数限制在每秒的指定次数，超过则拒绝访问，从而保护服务器安全 ")])),default:p((()=>[r("span",y,[m(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),S])])),_:1})]),r("h2",V,[m(l,{modelValue:d(G).status.active,"onUpdate:modelValue":t[0]||(t[0]=s=>d(G).status.active=s),onChange:L.change,disabled:!d(G).status.finish,"active-text":"我怂","inactive-text":"无所畏惧"},null,8,["modelValue","onChange","disabled"])]),k,r("span",j,[g(" 安全性提升，"),r("span",{onClick:t[1]||(t[1]=s=>L.show()),class:"text-dark pointer"},"点我配置")])])])),[[q,d(G).status.loading]]),m(O,{modelValue:d(G).status.dialog,"onUpdate:modelValue":t[6]||(t[6]=s=>d(G).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:p((()=>[C])),default:p((()=>[r("div",P,[r("div",I,[r("div",E,[r("label",M,[m(e,{content:"根据 IP 全局每秒限制的访问频率，推荐：50",placement:"top"},{default:p((()=>[r("span",null,[m(a,{name:"hint",size:"14px"}),T])])),_:1})]),m(A,{modelValue:d(G).struct.json.global,"onUpdate:modelValue":t[2]||(t[2]=s=>d(G).struct.json.global=s),min:10,class:"w-100 d-flex"},null,8,["modelValue"])])]),r("div",z,[r("div",Q,[r("label",U,[m(e,{content:"根据 IP + API 每秒限制的访问频率，推荐：15",placement:"top"},{default:p((()=>[r("span",null,[m(a,{name:"hint",size:"14px"}),Y])])),_:1})]),m(A,{modelValue:d(G).struct.json.point,"onUpdate:modelValue":t[3]||(t[3]=s=>d(G).struct.json.point=s),min:5,class:"w-100 d-flex"},null,8,["modelValue"])])])])])),footer:p((()=>[m(D,{onClick:t[4]||(t[4]=s=>d(G).status.dialog=!1)},{default:p((()=>[g("取 消")])),_:1}),m(D,{onClick:t[5]||(t[5]=s=>L.save()),loading:d(G).status.wait},{default:p((()=>[g("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},D={class:"card mb-3"},G={class:"card-body"},L={class:"text-muted text-uppercase mt-0"},O=r("strong",{class:"text-success"},"限制分页查询单次最大数据量，开启让系统毫无瑕疵！",-1),q=r("br",null,null,-1),J=r("br",null,null,-1),F=r("br",null,null,-1),N={class:"d-inline-flex align-items-center"},B=r("span",{class:"ms-1"},"分页限制",-1),H={class:"m-b-20"},K=r("span",{class:"badge bg-primary font-white"}," +5% ",-1),R={class:"text-muted ms-1"},W=r("strong",{class:"flex-center"},"配置",-1),X={class:"row"},Z={class:"col-md-12"},$={class:"form-group mb-3"},ss={class:"form-label"},ts=r("span",{class:"ms-1"},"最大值：",-1),as={__name:"page-limit",setup(v,{expose:b}){const h=a({struct:{text:10},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});e((async()=>{await x.init()}));const x={init:async()=>{h.status.finish=!1,h.status.loading=!0;const{code:t,data:a}=await s.get("/api/config/one",{key:"SYSTEM_PAGE_LIMIT"});200===t&&(h.struct=a,h.status.finish=!0,h.status.loading=!1)},show(){if(!h.status.finish)return t.warn("分页限制配置获取失败，无法进行配置！");h.status.dialog=!0},change:async a=>{const{code:e,msg:l}=await s.post("/api/config/save",{key:"SYSTEM_PAGE_LIMIT",value:a?1:0});200!==e&&(h.status.active=!a,t.error(l))},save:async()=>{h.status.wait=!0;const{code:a,msg:e}=await s.post("/api/config/save",{key:"SYSTEM_PAGE_LIMIT",text:h.struct.text});if(h.status.wait=!1,200!==a)return t.error("保存失败："+e);h.status.dialog=!1}};return l((()=>h.struct),(()=>{h.status.active=1===parseInt(h.struct.value),h.struct.text<5&&(h.struct.text=5)}),{deep:!0}),b({init:x.init}),(s,t)=>{const a=n("i-svg"),e=n("el-tooltip"),l=n("el-switch"),v=n("el-input-number"),b=n("el-button"),w=n("el-dialog"),_=o("loading");return i(),c(f,null,[u((i(),c("div",D,[r("div",G,[m(a,{name:"env",size:"50px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.7rem"}}),r("h6",L,[m(e,{placement:"top"},{content:p((()=>[O,q,g(" 分页限制可以限制坏人发起恶意请求，如恶意请求 999999 乃至无限大的数据，"),J,g(" 导致服务器崩溃，分页限制可以限制每页最大请求数据量，超过则强制性=最大值"),F,g(" 注意：如果开启了缓存，此项可不开，因为缓存数据不会导致重复查询 ")])),default:p((()=>[r("span",N,[m(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),B])])),_:1})]),r("h2",H,[m(l,{modelValue:d(h).status.active,"onUpdate:modelValue":t[0]||(t[0]=s=>d(h).status.active=s),onChange:x.change,disabled:!d(h).status.finish,"active-text":"我怂","inactive-text":"无所畏惧"},null,8,["modelValue","onChange","disabled"])]),K,r("span",R,[g(" 安全性提升，"),r("span",{onClick:t[1]||(t[1]=s=>x.show()),class:"text-dark pointer"},"点我配置")])])])),[[_,d(h).status.loading]]),m(w,{modelValue:d(h).status.dialog,"onUpdate:modelValue":t[5]||(t[5]=s=>d(h).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:p((()=>[W])),default:p((()=>[r("div",X,[r("div",Z,[r("div",$,[r("label",ss,[m(e,{content:"限制分页查询单次最大数据量，推荐：30",placement:"top"},{default:p((()=>[r("span",null,[m(a,{name:"hint",size:"14px"}),ts])])),_:1})]),m(v,{modelValue:d(h).struct.text,"onUpdate:modelValue":t[2]||(t[2]=s=>d(h).struct.text=s),min:5,class:"w-100 d-flex"},null,8,["modelValue"])])])])])),footer:p((()=>[m(b,{onClick:t[3]||(t[3]=s=>d(h).status.dialog=!1)},{default:p((()=>[g("取 消")])),_:1}),m(b,{onClick:t[4]||(t[4]=s=>x.save()),loading:d(h).status.wait},{default:p((()=>[g("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}};export{A as _,as as a};
