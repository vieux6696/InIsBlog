import{s as e}from"./1711946477.@howdyjs.js";import{a as s,n as a,u as t,c as l,I as n,b as o,h as c,l as i}from"./1711946477.index.js";import{a6 as r,y as u,w as d,aj as m,as as p,o as f,c as g,l as b,J as v,a as h,s as y,a2 as w,a3 as x,ac as _,f as k,i as V,F as z,g as S,q as j,m as C,K as U}from"./1711946477.@vue.js";import{_ as O}from"./1711946477.api-key.js";import{_ as q,a as R}from"./1711946477.page-limit.js";import{_ as K}from"./1711946477.qps-black.js";import{_ as I}from"./1711946477.page2.js";import{_ as J}from"./1711946477.article2.js";import{M as A}from"./1711946477.markdown-it.js";import"./1711946477.lscache.js";import"./1711946477.crypto-js.js";import"./1711946477.axios.js";import"./1711946477.element-plus.js";import"./1711946477.lodash-es.js";import"./1711946477.@element-plus.js";import"./1711946477.@popperjs.js";import"./1711946477.@ctrl.js";import"./1711946477.dayjs.js";import"./1711946477.async-validator.js";import"./1711946477.memoize-one.js";import"./1711946477.normalize-wheel-es.js";import"./1711946477.@floating-ui.js";import"./1711946477.notyf.js";import"./1711946477.pinia.js";import"./1711946477.vue-router.js";import"./1711946477.lottie-web.js";import"./1711946477.bootstrap.js";import"./1711946477.plyr.js";import"./1711946477.@fancyapps.js";import"./1711946477.highlight.js.js";import"./1711946477.entities.js";import"./1711946477.uc.micro.js";import"./1711946477.mdurl.js";import"./1711946477.linkify-it.js";import"./1711946477.punycode.js";const N={class:"card mb-3"},D={class:"card-body"},$={class:"text-muted text-uppercase mt-0"},E=h("br",null,null,-1),P={class:"d-inline-flex align-items-center"},T=h("span",{class:"ms-1"},"邮件服务",-1),L={class:"m-b-20"},M=h("span",{class:"badge bg-danger font-white"}," 推荐 ",-1),B={class:"text-muted"},W=h("strong",{class:"flex-center"},"配置邮件服务",-1),X={class:"row"},F={class:"col-md-6"},H={class:"form-group mb-3"},Y={class:"form-label required"},G=h("span",{class:"ms-1"},"邮件服务器地址：",-1),Q={class:"col-md-6"},Z={class:"form-group mb-3"},ee={class:"form-label required"},se=h("span",{class:"ms-1"},"邮件服务端口：",-1),ae={class:"row"},te={class:"col-md-6"},le={class:"form-group mb-3"},ne={class:"form-label required"},oe=h("span",{class:"ms-1"},"邮件账号：",-1),ce={class:"col-md-6"},ie={class:"form-group mb-3"},re={class:"form-label required"},ue=h("span",{class:"ms-1"},"服务密码：",-1),de={class:"row"},me={class:"col-md-6"},pe={class:"form-group mb-3"},fe={class:"form-label"},ge=h("span",{class:"ms-1"},"邮件昵称：",-1),be={class:"col-md-6"},ve={class:"form-group mb-3"},he={class:"form-label"},ye=h("span",{class:"ms-1"},"邮件签名：",-1),we={class:"col-12"},xe={class:"form-group mb-3"},_e={class:"form-label"},ke=h("span",{class:"ms-1"},"接收者邮箱：",-1),Ve=h("span",{class:"ms-1"},"邮件服务测试",-1),ze={__name:"sms-email",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=r({struct:{email:null,host:null,port:null,account:null,password:null,nickname:null,sign_name:null,drive:{email:null,default:null}},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{}});u((async()=>{await c.init()}));const c={init:async()=>{o.status.finish=!1,o.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/sms",{name:"email"});o.status.loading=!1,200===e&&(o.struct=a,o.backup=JSON.parse(JSON.stringify(a)),o.status.finish=!0)},show(){if(!o.status.finish)return a.warn("邮件服务配置获取失败，无法进行配置！");o.status.dialog=!0},change:async e=>{const{code:t,msg:l}=await s.put("/api/toml/sms-drive",{email:e?"email":""});200!==t&&(o.status.active=!e,a.error(l))},save:async()=>{if(!t.object.equal(o.struct,o.backup,["host","port","account","password"]))return a.warn("请先完成邮件服务测试");if(t.is.empty(o.struct.host))return a.warn("请填写邮件服务器地址！");if(t.is.empty(o.struct.port))return a.warn("请填写邮件服务器端口！");if(t.is.empty(o.struct.account))return a.warn("请填写邮件账号！");if(t.is.empty(o.struct.password))return a.warn("请填写服务密码！");if(t.is.empty(o.struct.sign_name))return a.warn("请填写邮件签名！");if(c.chinese(o.struct.nickname))return a.warn("邮件昵称不能包含中文！");o.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/sms-email",o.struct);if(o.status.wait=!1,200!==e)return a.error("保存失败："+l);o.status.dialog=!1},test:async()=>{if(t.is.empty(o.struct.email))return a.warn("请填写接收者邮箱！");if(t.is.empty(o.struct.host))return a.warn("请填写邮件服务器地址！");if(t.is.empty(o.struct.port))return a.warn("请填写邮件服务器端口！");if(t.is.empty(o.struct.account))return a.warn("请填写邮件账号！");if(t.is.empty(o.struct.password))return a.warn("请填写服务密码！");if(t.is.empty(o.struct.sign_name))return a.warn("请填写邮件签名！");if(!t.is.email(o.struct.email))return a.warn("接收者邮箱格式不正确！");if(c.chinese(o.struct.nickname))return a.warn("邮件昵称不能包含中文！");o.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-sms-email",o.struct);if(o.status.test=!1,200===e)return o.backup=JSON.parse(JSON.stringify(o.struct)),a.success(l);a.error(`${l}<br>${n}`)},chinese:e=>/[\u4e00-\u9fa5]/.test(e)};return d((()=>o.struct),(()=>{o.status.active="email"===o.struct.drive.email}),{deep:!0}),l({init:c.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),i=m("el-input-number"),r=m("el-button"),u=m("el-dialog"),d=p("loading");return f(),g(z,null,[b((f(),g("div",N,[h("div",D,[y(a,{name:"email",color:"rgb(var(--assist-color))",size:"55px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",$,[y(t,{placement:"top"},{content:w((()=>[x(" ● 用于发送验证码、通知等邮件相关的服务"),E,x(" ● 注册、找回密码、通知等功能都需要依赖此服务 ")])),default:w((()=>[h("span",P,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),T])])),_:1})]),h("h2",L,[y(l,{modelValue:v(o).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(o).status.active=e),onChange:c.change,disabled:!v(o).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),M,h("span",B,[x(" 因为不花钱，"),h("span",{onClick:s[1]||(s[1]=e=>c.show()),class:"text-dark pointer"},"点我配置")])])])),[[d,v(o).status.loading]]),y(u,{modelValue:v(o).status.dialog,"onUpdate:modelValue":s[13]||(s[13]=e=>v(o).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[W])),default:w((()=>[h("div",X,[h("div",F,[h("div",H,[h("label",Y,[y(t,{content:"邮件服务器地址，如：smtp.qq.com",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),G])])),_:1})]),y(n,{modelValue:v(o).struct.host,"onUpdate:modelValue":s[2]||(s[2]=e=>v(o).struct.host=e)},null,8,["modelValue"])])]),h("div",Q,[h("div",Z,[h("label",ee,[y(t,{content:"邮件服务端口，如：465",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),se])])),_:1})]),y(i,{modelValue:v(o).struct.port,"onUpdate:modelValue":s[3]||(s[3]=e=>v(o).struct.port=e),class:"w-100 d-flex","controls-position":"right",min:1},null,8,["modelValue"])])])]),h("div",ae,[h("div",te,[h("div",le,[h("label",ne,[y(t,{content:"邮件账号，如：xxx@qq.com",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),oe])])),_:1})]),y(n,{modelValue:v(o).struct.account,"onUpdate:modelValue":s[4]||(s[4]=e=>v(o).struct.account=e)},null,8,["modelValue"])])]),h("div",ce,[h("div",ie,[h("label",re,[y(t,{content:"服务密码，不是邮箱密码",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ue])])),_:1})]),y(n,{modelValue:v(o).struct.password,"onUpdate:modelValue":s[5]||(s[5]=e=>v(o).struct.password=e),"show-password":""},null,8,["modelValue"])])])]),h("div",de,[h("div",me,[h("div",pe,[h("label",fe,[y(t,{content:"邮件昵称，可以为空，但不能包含中文",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ge])])),_:1})]),y(n,{modelValue:v(o).struct.nickname,"onUpdate:modelValue":s[6]||(s[6]=e=>v(o).struct.nickname=e)},null,8,["modelValue"])])]),h("div",be,[h("div",ve,[h("label",he,[y(t,{content:"邮件签名，也就是邮件的主题或标题，不推荐为空",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ye])])),_:1})]),y(n,{modelValue:v(o).struct.sign_name,"onUpdate:modelValue":s[7]||(s[7]=e=>v(o).struct.sign_name=e)},null,8,["modelValue"])])]),h("div",we,[h("div",xe,[h("label",_e,[y(t,{content:"用于邮件服务测试接收测试信息的邮箱",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ke])])),_:1})]),y(n,{modelValue:v(o).struct.email,"onUpdate:modelValue":s[9]||(s[9]=e=>v(o).struct.email=e),onKeydown:s[10]||(s[10]=_((e=>c.test()),["enter"])),class:"custom",placeholder:"请输入邮箱"},{suffix:w((()=>[y(r,{onClick:s[8]||(s[8]=e=>c.test()),loading:v(o).status.test},{default:w((()=>[v(o).status.test?V("",!0):(f(),k(a,{key:0,name:"email",size:"14px"})),Ve])),_:1},8,["loading"])])),_:1},8,["modelValue"])])])])])),footer:w((()=>[y(r,{onClick:s[11]||(s[11]=e=>v(o).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(r,{onClick:s[12]||(s[12]=e=>c.save()),loading:v(o).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},Se={class:"card mb-3"},je={class:"card-body"},Ce={class:"text-muted text-uppercase mt-0"},Ue=h("br",null,null,-1),Oe={class:"d-inline-flex align-items-center"},qe=h("span",{class:"ms-1"},"阿里云短信",-1),Re={class:"m-b-20"},Ke=h("span",{class:"badge bg-warning font-white"}," 企业 ",-1),Ie={class:"text-muted"},Je=h("strong",{class:"flex-center"},"配置阿里云短信服务",-1),Ae={class:"row"},Ne={class:"col-md-6"},De={class:"form-group mb-3"},$e={class:"form-label required"},Ee=h("span",{class:"ms-1"},"AccessKey ID：",-1),Pe={class:"col-md-6"},Te={class:"form-group mb-3"},Le={class:"form-label required"},Me=h("span",{class:"ms-1"},"AccessKey Secret：",-1),Be={class:"row"},We={class:"col-md-4"},Xe={class:"form-group mb-3"},Fe={class:"form-label required"},He=h("span",{class:"ms-1"},"endpoint：",-1),Ye={class:"col-md-4"},Ge={class:"form-group mb-3"},Qe={class:"form-label required"},Ze=h("span",{class:"ms-1"},"短信签名：",-1),es={class:"col-md-4"},ss={class:"form-group mb-3"},as={class:"form-label required"},ts=h("span",{class:"ms-1"},"验证码模板：",-1),ls={class:"row"},ns={class:"col-12"},os={class:"form-group mb-3"},cs={class:"form-label"},is=h("span",{class:"ms-1"},"接收者手机号：",-1),rs=h("span",{class:"ms-1"},"阿里云短信测试",-1),us={__name:"sms-aliyun",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{access_key_id:null,access_key_secret:null,endpoint:null,sign_name:null,verify_code:null,phone:null,drive:{sms:null,default:null}},status:{finish:!1,active:!1,dialog:!1,loading:!0,test:!1,wait:!1},backup:{}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/sms",{name:"aliyun"});c.status.loading=!1,200===e&&(c.struct=a,c.backup=JSON.parse(JSON.stringify(a)),c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("SMS服务配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{const{code:t,msg:l}=await s.put("/api/toml/sms-drive",{sms:e?"aliyun":""});if(200===t)return o("refresh","sms-tencent");c.status.active=!e,a.error(l)},save:async()=>{if(!t.object.equal(c.struct,c.backup,["access_key_id","access_key_secret","endpoint","sign_name","verify_code"]))return a.warn("请先完成阿里云短信测试");if(t.is.empty(c.struct.access_key_id))return a.warn("请填写阿里云AccessKey ID！");if(t.is.empty(c.struct.access_key_secret))return a.warn("请填写阿里云AccessKey Secret！");if(t.is.empty(c.struct.endpoint))return a.warn("请填写阿里云短信服务endpoint！");if(t.is.empty(c.struct.sign_name))return a.warn("请填写短信签名！");if(t.is.empty(c.struct.verify_code))return a.warn("请填写验证码模板！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/sms-aliyun",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1},test:async()=>{if(t.is.empty(c.struct.phone))return a.warn("请填写接收者手机号！");if(t.is.empty(c.struct.access_key_id))return a.warn("请填写阿里云AccessKey ID！");if(t.is.empty(c.struct.access_key_secret))return a.warn("请填写阿里云AccessKey Secret！");if(t.is.empty(c.struct.endpoint))return a.warn("请填写阿里云短信服务endpoint！");if(t.is.empty(c.struct.sign_name))return a.warn("请填写短信签名！");if(t.is.empty(c.struct.verify_code))return a.warn("请填写验证码模板！");if(!t.is.phone(c.struct.phone))return a.warn("接收者手机号格式不正确！");c.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-sms-aliyun",c.struct);if(c.status.test=!1,200===e)return c.backup=JSON.parse(JSON.stringify(c.struct)),a.success(l);a.error(`${l}<br>${n}`)}};return d((()=>c.struct),(()=>{c.status.active="aliyun"===c.struct.drive.sms}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-button"),r=m("el-dialog"),u=p("loading");return f(),g(z,null,[b((f(),g("div",Se,[h("div",je,[y(a,{name:"aliyun",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Ce,[y(t,{placement:"top"},{content:w((()=>[x(" ● 用于发送验证码相关的服务"),Ue,x(" ● 注册、找回密码、通知等功能都需要依赖此服务 ")])),default:w((()=>[h("span",Oe,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),qe])])),_:1})]),h("h2",Re,[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),Ke,h("span",Ie,[x(" 企业推荐这个，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[u,v(c).status.loading]]),y(r,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[12]||(s[12]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[Je])),default:w((()=>[h("div",Ae,[h("div",Ne,[h("div",De,[h("label",$e,[y(t,{content:"阿里云 AccessKey ID",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ee])])),_:1})]),y(n,{modelValue:v(c).struct.access_key_id,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.access_key_id=e),"show-password":""},null,8,["modelValue"])])]),h("div",Pe,[h("div",Te,[h("label",Le,[y(t,{content:"阿里云 AccessKey Secret",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Me])])),_:1})]),y(n,{modelValue:v(c).struct.access_key_secret,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.access_key_secret=e),"show-password":""},null,8,["modelValue"])])])]),h("div",Be,[h("div",We,[h("div",Xe,[h("label",Fe,[y(t,{content:"阿里云 短信服务 endpoint，如：dysmsapi.aliyuncs.com",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),He])])),_:1})]),y(n,{modelValue:v(c).struct.endpoint,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.endpoint=e)},null,8,["modelValue"])])]),h("div",Ye,[h("div",Ge,[h("label",Qe,[y(t,{content:"短信签名，如：萌卜兔",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ze])])),_:1})]),y(n,{modelValue:v(c).struct.sign_name,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).struct.sign_name=e)},null,8,["modelValue"])])]),h("div",es,[h("div",ss,[h("label",as,[y(t,{content:"验证码模板，如：SMS_XXX02",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ts])])),_:1})]),y(n,{modelValue:v(c).struct.verify_code,"onUpdate:modelValue":s[6]||(s[6]=e=>v(c).struct.verify_code=e)},null,8,["modelValue"])])])]),h("div",ls,[h("div",ns,[h("div",os,[h("label",cs,[y(t,{content:"用于阿里云短信测试接收测试信息的手机号",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),is])])),_:1})]),y(n,{modelValue:v(c).struct.phone,"onUpdate:modelValue":s[8]||(s[8]=e=>v(c).struct.phone=e),onKeydown:s[9]||(s[9]=_((e=>i.test()),["enter"])),class:"custom",placeholder:"请输入手机号"},{suffix:w((()=>[y(o,{onClick:s[7]||(s[7]=e=>i.test()),loading:v(c).status.test},{default:w((()=>[v(c).status.test?V("",!0):(f(),k(a,{key:0,name:"phone",size:"14px"})),rs])),_:1},8,["loading"])])),_:1},8,["modelValue"])])])])])),footer:w((()=>[y(o,{onClick:s[10]||(s[10]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(o,{onClick:s[11]||(s[11]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},ds={class:"card mb-3"},ms={class:"card-body"},ps={class:"text-muted text-uppercase mt-0"},fs=h("br",null,null,-1),gs={class:"d-inline-flex align-items-center"},bs=h("span",{class:"ms-1"},"腾讯云短信",-1),vs={class:"m-b-20"},hs=h("span",{class:"badge bg-primary font-white"}," 企业 ",-1),ys={class:"text-muted"},ws=h("strong",{class:"flex-center"},"配置腾讯云短信服务",-1),xs={class:"row"},_s={class:"col-md-6"},ks={class:"form-group mb-3"},Vs={class:"form-label required"},zs=h("span",{class:"ms-1"},"SecretId：",-1),Ss={class:"col-md-6"},js={class:"form-group mb-3"},Cs={class:"form-label required"},Us=h("span",{class:"ms-1"},"SecretKey：",-1),Os={class:"row"},qs={class:"col-md-6"},Rs={class:"form-group mb-3"},Ks={class:"form-label required"},Is=h("span",{class:"ms-1"},"endpoint：",-1),Js={class:"col-md-6"},As={class:"form-group mb-3"},Ns={class:"form-label required"},Ds=h("span",{class:"ms-1"},"appid：",-1),$s={class:"row"},Es={class:"col-md-4"},Ps={class:"form-group mb-3"},Ts={class:"form-labe requiredl"},Ls=h("span",{class:"ms-1"},"短信签名：",-1),Ms={class:"col-md-4"},Bs={class:"form-group mb-3"},Ws={class:"form-label required"},Xs=h("span",{class:"ms-1"},"验证码模板 id：",-1),Fs={class:"col-md-4"},Hs={class:"form-group mb-3"},Ys={class:"form-label required"},Gs=h("span",{class:"ms-1"},"区域：",-1),Qs={class:"col-12"},Zs={class:"form-group mb-3"},ea={class:"form-label"},sa=h("span",{class:"ms-1"},"接收者手机号：",-1),aa=h("span",{class:"ms-1"},"腾讯云短信测试",-1),ta={__name:"sms-tencent",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{phone:null,secret_id:null,secret_key:null,endpoint:null,sms_sdk_app_id:null,sign_name:null,verify_code:null,region:null,drive:{sms:null,default:null}},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/sms",{name:"tencent"});c.status.loading=!1,200===e&&(c.struct=a,c.backup=JSON.parse(JSON.stringify(a)),c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{const{code:t,msg:l}=await s.put("/api/toml/sms-drive",{sms:e?"tencent":""});if(200===t)return o("refresh","sms-aliyun");c.status.active=!e,a.error(l)},save:async()=>{if(!t.object.equal(c.struct,c.backup,["secret_id","secret_key","endpoint","sms_sdk_app_id","sign_name","verify_code","region"]))return a.warn("请先完成邮件服务测试");if(t.is.empty(c.struct.secret_id))return a.warn("请填写 SecretId！");if(t.is.empty(c.struct.secret_key))return a.warn("请填写 SecretKey！");if(t.is.empty(c.struct.endpoint))return a.warn("请填写 endpoint！");if(t.is.empty(c.struct.sms_sdk_app_id))return a.warn("请填写 appid！");if(t.is.empty(c.struct.sign_name))return a.warn("请填写 短信签名！");if(t.is.empty(c.struct.verify_code))return a.warn("请填写 验证码模板 id！");if(t.is.empty(c.struct.region))return a.warn("请填写 区域！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/sms-tencent",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1},test:async()=>{if(t.is.empty(c.struct.phone))return a.warn("请填写接收者手机号！");if(t.is.empty(c.struct.secret_id))return a.warn("请填写 SecretId！");if(t.is.empty(c.struct.secret_key))return a.warn("请填写 SecretKey！");if(t.is.empty(c.struct.endpoint))return a.warn("请填写 endpoint！");if(t.is.empty(c.struct.sms_sdk_app_id))return a.warn("请填写 appid！");if(t.is.empty(c.struct.sign_name))return a.warn("请填写 短信签名！");if(t.is.empty(c.struct.verify_code))return a.warn("请填写 验证码模板 id！");if(t.is.empty(c.struct.region))return a.warn("请填写 区域！");if(!t.is.phone(c.struct.phone))return a.warn("接收者手机号格式不正确！");c.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-sms-tencent",c.struct);if(c.status.test=!1,200===e)return c.backup=JSON.parse(JSON.stringify(c.struct)),a.success(l);a.error(`${l}<br>${n}`)}};return d((()=>c.struct),(()=>{c.status.active="tencent"===c.struct.drive.sms}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-button"),r=m("el-dialog"),u=p("loading");return f(),g(z,null,[b((f(),g("div",ds,[h("div",ms,[y(a,{name:"tencent",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",ps,[y(t,{placement:"top"},{content:w((()=>[x(" ● 用于发送验证码相关的服务"),fs,x(" ● 注册、找回密码、通知等功能都需要依赖此服务 ")])),default:w((()=>[h("span",gs,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),bs])])),_:1})]),h("h2",vs,[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),hs,h("span",ys,[x(" 也可以用这个，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[u,v(c).status.loading]]),y(r,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[14]||(s[14]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[ws])),default:w((()=>[h("div",xs,[h("div",_s,[h("div",ks,[h("label",Vs,[y(t,{content:"腾讯云 SecretId",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),zs])])),_:1})]),y(n,{modelValue:v(c).struct.secret_id,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.secret_id=e),"show-password":""},null,8,["modelValue"])])]),h("div",Ss,[h("div",js,[h("label",Cs,[y(t,{content:"腾讯云 SecretKey",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Us])])),_:1})]),y(n,{modelValue:v(c).struct.secret_key,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.secret_key=e),"show-password":""},null,8,["modelValue"])])])]),h("div",Os,[h("div",qs,[h("div",Rs,[h("label",Ks,[y(t,{content:"腾讯云短信服务 endpoint",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Is])])),_:1})]),y(n,{modelValue:v(c).struct.endpoint,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.endpoint=e)},null,8,["modelValue"])])]),h("div",Js,[h("div",As,[h("label",Ns,[y(t,{content:"腾讯云短信服务 appid",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ds])])),_:1})]),y(n,{modelValue:v(c).struct.sms_sdk_app_id,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).struct.sms_sdk_app_id=e)},null,8,["modelValue"])])])]),h("div",$s,[h("div",Es,[h("div",Ps,[h("label",Ts,[y(t,{content:"短信签名，如：萌卜兔",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ls])])),_:1})]),y(n,{modelValue:v(c).struct.sign_name,"onUpdate:modelValue":s[6]||(s[6]=e=>v(c).struct.sign_name=e)},null,8,["modelValue"])])]),h("div",Ms,[h("div",Bs,[h("label",Ws,[y(t,{content:"验证码模板 id，如：146XXX",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Xs])])),_:1})]),y(n,{modelValue:v(c).struct.verify_code,"onUpdate:modelValue":s[7]||(s[7]=e=>v(c).struct.verify_code=e)},null,8,["modelValue"])])]),h("div",Fs,[h("div",Hs,[h("label",Ys,[y(t,{content:"短信服务所属区域，如：ap-guangzhou",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Gs])])),_:1})]),y(n,{modelValue:v(c).struct.region,"onUpdate:modelValue":s[8]||(s[8]=e=>v(c).struct.region=e)},null,8,["modelValue"])])]),h("div",Qs,[h("div",Zs,[h("label",ea,[y(t,{content:"用于腾讯云短信测试接收测试信息的手机号",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),sa])])),_:1})]),y(n,{modelValue:v(c).struct.phone,"onUpdate:modelValue":s[10]||(s[10]=e=>v(c).struct.phone=e),onKeydown:s[11]||(s[11]=_((e=>i.test()),["enter"])),class:"custom",placeholder:"请输入手机号"},{suffix:w((()=>[y(o,{onClick:s[9]||(s[9]=e=>i.test()),loading:v(c).status.test},{default:w((()=>[v(c).status.test?V("",!0):(f(),k(a,{key:0,name:"phone",size:"14px"})),aa])),_:1},8,["loading"])])),_:1},8,["modelValue"])])])])])),footer:w((()=>[y(o,{onClick:s[12]||(s[12]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(o,{onClick:s[13]||(s[13]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},la={class:"card mb-3"},na={class:"card-body"},oa={class:"text-muted text-uppercase mt-0"},ca=h("br",null,null,-1),ia={class:"d-inline-flex align-items-center"},ra=h("span",{class:"ms-1"},"注 册",-1),ua={class:"m-b-20"},da=h("span",{class:"badge bg-primary font-white"}," +0.1% ",-1),ma={class:"text-muted ms-1"},pa=h("strong",{class:"flex-center"},"配置",-1),fa={class:"row"},ga={class:"col-lg-6"},ba={class:"form-group mb-3"},va={class:"form-label"},ha=h("span",null,"（可选）为该分组的用户分配更高级的权限",-1),ya=h("br",null,null,-1),wa=h("span",null,"● 默认：即便用户拥有了对应的权限，也只能操作自己的数据，适用于普通用户或会员",-1),xa=h("br",null,null,-1),_a=h("span",null,"● 管理权限：该权限适用于有管理权限的用户，比如管理员和编辑员等，对别人的数据有操作权限",-1),ka=h("br",null,null,-1),Va=h("span",{class:"ms-1"},"注册：",-1),za={class:"font-13"},Sa={class:"col-lg-6"},ja={class:"form-group mb-3"},Ca={class:"form-label"},Ua=h("span",{class:"ms-1"},"分配权限：",-1),Oa={class:"font-13 d-flex align-items-center"},qa={class:"text-muted"},Ra={__name:"allow-register",setup(e,{expose:l}){const n=r({item:{auth:[]},struct:{key:"ALLOW_REGISTER"},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1},select:{auth:[],value:[{value:"0",label:"禁止注册",color:"var(--bs-danger)"},{value:"1",label:"允许注册",color:"var(--bs-success)"}]}}),o={init:async()=>{n.status.finish=!1,n.status.loading=!0;const{code:e,data:a}=await s.get("/api/config/one",{key:"ALLOW_REGISTER"});n.status.loading=!1,200===e&&(n.struct=a,n.status.finish=!0)},change:async e=>{const{code:t,msg:l}=await s.post("/api/config/save",{key:"ALLOW_REGISTER",value:e?1:0});200!==t&&(n.status.active=!e,a.error(l))},show(){if(!n.status.finish)return a.warn("配置获取失败，无法进行配置！");n.status.dialog=!0},save:async()=>{n.status.wait=!0;const{code:e,msg:t}=await s.post("/api/config/save",{...n.struct,text:n.item.auth});if(n.status.wait=!1,200!==e)return a.error("保存失败："+t);n.status.dialog=!1},auth:async()=>{const{code:e,data:a}=await s.get("/api/auth-group/column",{field:"id,key,name,root"});200===e&&(n.select.auth=a.map((e=>(e.color=1===e.root?"var(--bs-success)":"var(--bs-secondary)",e))))}};return u((()=>{o.init(),o.auth()})),d((()=>n.struct),(e=>{var s,a;n.item.auth=((null==(s=null==e?void 0:e.text)?void 0:s.split(","))||[]).filter((e=>!t.is.empty(e))).map((e=>parseInt(e))),n.status.active=1===parseInt(null==(a=n.struct)?void 0:a.value)}),{deep:!0}),d((()=>n.status.active),(e=>{n.struct.value=e?"1":"0"})),l({init:o.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),c=m("el-option"),i=m("el-select"),r=m("el-button"),u=m("el-dialog"),d=p("loading");return f(),g(z,null,[b((f(),g("div",la,[h("div",na,[y(a,{name:"register",color:"rgb(var(--assist-color))",size:"50px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",oa,[y(t,{placement:"top"},{content:w((()=>[x(" ● 是否允许用户自行注册账号（开放注册功能？）"),ca,x(" ● 如果不允许，那么只能通过管理员手动创建账号 ")])),default:w((()=>[h("span",ia,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),ra])])),_:1})]),h("h2",ua,[y(l,{modelValue:v(n).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(n).status.active=e),onChange:o.change,disabled:!v(n).status.finish,"active-text":"允许","inactive-text":"不允许"},null,8,["modelValue","onChange","disabled"])]),da,h("span",ma,[x(" 安全性提升，"),h("span",{onClick:s[1]||(s[1]=e=>o.show()),class:"text-dark pointer"},"点我配置")])])])),[[d,v(n).status.loading]]),y(u,{modelValue:v(n).status.dialog,"onUpdate:modelValue":s[6]||(s[6]=e=>v(n).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[pa])),default:w((()=>[h("div",fa,[h("div",ga,[h("div",ba,[h("label",va,[y(t,{placement:"top"},{content:w((()=>[ha,ya,wa,xa,_a,ka])),default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),Va])])),_:1})]),y(i,{modelValue:v(n).struct.value,"onUpdate:modelValue":s[2]||(s[2]=e=>v(n).struct.value=e),placeholder:"请选择权限",class:"d-block custom font-13"},{default:w((()=>[(f(!0),g(z,null,S(v(n).select.value,(e=>(f(),k(c,{key:e.value,label:e.label,value:e.value,class:"d-flex align-items-center"},{default:w((()=>[y(a,{name:"dot",color:e.color,size:"20px"},null,8,["color"]),h("span",za,j(e.label),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])]),h("div",Sa,[h("div",ja,[h("label",Ca,[y(t,{content:"为注册的用户分配默认的权限",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),Ua])])),_:1})]),y(i,{modelValue:v(n).item.auth,"onUpdate:modelValue":s[3]||(s[3]=e=>v(n).item.auth=e),"reserve-keyword":!1,"default-first-option":"","collapse-tags-tooltip":"","allow-create":"",multiple:"",filterable:"","collapse-tags":"",class:"d-block custom font-13",placeholder:"选择注册的默认权限"},{default:w((()=>[(f(!0),g(z,null,S(v(n).select.auth,(e=>(f(),k(c,{key:e.id,label:e.name,value:e.id,class:"d-flex justify-content-between"},{default:w((()=>[h("span",Oa,[y(a,{name:"dot",color:e.color,size:"20px"},null,8,["color"]),x(" "+j(e.name),1)]),h("small",qa,j(e.key),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])])])),footer:w((()=>[y(r,{onClick:s[4]||(s[4]=e=>v(n).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(r,{onClick:s[5]||(s[5]=e=>o.save()),loading:v(n).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},Ka={class:"card mb-3"},Ia={class:"card-body"},Ja={class:"text-muted text-uppercase mt-0"},Aa=h("br",null,null,-1),Na={class:"d-inline-flex align-items-center"},Da=h("span",{class:"ms-1"},"JWT",-1),$a={class:"m-b-20"},Ea=h("span",{class:"badge bg-primary font-white"}," +5% ",-1),Pa={class:"text-muted ms-1"},Ta=h("strong",{class:"flex-center"},"配置 JSON Web Token",-1),La={class:"row"},Ma={class:"col-md-6"},Ba={class:"form-group mb-3"},Wa={class:"form-label required"},Xa=h("span",{class:"ms-1"},"签发者：",-1),Fa={class:"col-md-6"},Ha={class:"form-group mb-3"},Ya={class:"form-label required"},Ga=h("span",{class:"ms-1"},"主题：",-1),Qa={class:"col-md-6"},Za={class:"form-group mb-3"},et={class:"form-label required"},st=h("span",{class:"ms-1"},"密钥：",-1),at=h("span",{class:"ms-1"},"随机",-1),tt={class:"col-md-6"},lt={class:"form-group mb-3"},nt={class:"form-label required"},ot=h("span",{class:"ms-1"},"过期时间(秒)：",-1),ct={__name:"jwt",setup(e,{expose:t}){const l=r({struct:{key:null,issuer:null,subject:null,expire:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1}});u((async()=>{await n.init()}));const n={init:async()=>{l.status.finish=!1,l.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/crypt",{name:"jwt"});l.status.loading=!1,200===e&&(l.struct=a,l.status.finish=!0)},show(){if(!l.status.finish)return a.warn("分页限制配置获取失败，无法进行配置！");l.status.dialog=!0},change:async e=>{e||(l.status.active=!0,a.warn("？？？？？？？？？？？？？<br>JWT是基础服务，这可不许关"))},save:async()=>{l.status.wait=!0;const{code:e,msg:t}=await s.put("/api/toml/crypt-jwt",l.struct);if(l.status.wait=!1,200!==e)return a.error("保存失败："+t);l.status.dialog=!1},rand(e="key"){let s="INIS-";const a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(let t=0;t<32;t++)s+=a.charAt(Math.floor(62*Math.random()));l.struct[e]=s}};return d((()=>l.struct),(()=>{l.struct.key=l.struct.key.replace(/[^\w!@#$%^&*()_+\-=\[\]{};:'"\\|\/?,.<>~`\s]/g,""),l.struct.expire=l.struct.expire.replace(/[^\d\s*+\-\/]/g,"")}),{deep:!0}),t({init:n.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),o=m("el-switch"),c=m("el-input"),i=m("el-button"),r=m("el-dialog"),u=p("loading");return f(),g(z,null,[b((f(),g("div",Ka,[h("div",Ia,[y(a,{name:"crypt",size:"55px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Ja,[y(t,{placement:"top"},{content:w((()=>[x(" JWT（JSON Web Token）是一种在网络应用中传递声明信息的轻量级、安全的方式。"),Aa,x(" JWT具有通用性和可扩展性，可以应用在很多场景，比如用户认证、单点登录、API访问授权等。 ")])),default:w((()=>[h("span",Na,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),Da])])),_:1})]),h("h2",$a,[y(o,{modelValue:v(l).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(l).status.active=e),onChange:n.change,disabled:!v(l).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),Ea,h("span",Pa,[x(" 安全性提升，"),h("span",{onClick:s[1]||(s[1]=e=>n.show()),class:"text-dark pointer"},"点我配置")])])])),[[u,v(l).status.loading]]),y(r,{modelValue:v(l).status.dialog,"onUpdate:modelValue":s[9]||(s[9]=e=>v(l).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[Ta])),default:w((()=>[h("div",La,[h("div",Ma,[h("div",Ba,[h("label",Wa,[y(t,{content:"签发者，比如：萌卜兔",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Xa])])),_:1})]),y(c,{modelValue:v(l).struct.issuer,"onUpdate:modelValue":s[2]||(s[2]=e=>v(l).struct.issuer=e)},null,8,["modelValue"])])]),h("div",Fa,[h("div",Ha,[h("label",Ya,[y(t,{content:"主题，比如：萌卜兔",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ga])])),_:1})]),y(c,{modelValue:v(l).struct.subject,"onUpdate:modelValue":s[3]||(s[3]=e=>v(l).struct.subject=e)},null,8,["modelValue"])])]),h("div",Qa,[h("div",Za,[h("label",et,[y(t,{content:"生成JWT的密钥，建议复杂度高一些",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),st])])),_:1})]),y(c,{modelValue:v(l).struct.key,"onUpdate:modelValue":s[5]||(s[5]=e=>v(l).struct.key=e),class:"custom",placeholder:"请输入验证码"},{suffix:w((()=>[y(i,{onClick:s[4]||(s[4]=e=>n.rand())},{default:w((()=>[y(a,{name:"restore",color:"rgb(var(--vice-color))",size:"14px"}),at])),_:1})])),_:1},8,["modelValue"])])]),h("div",tt,[h("div",lt,[h("label",nt,[y(t,{content:"签名有效期，可以用乘法，如：7 * 24 * 60 * 60 表示7天",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ot])])),_:1})]),y(c,{modelValue:v(l).struct.expire,"onUpdate:modelValue":s[6]||(s[6]=e=>v(l).struct.expire=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(i,{onClick:s[7]||(s[7]=e=>v(l).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(i,{onClick:s[8]||(s[8]=e=>n.save()),loading:v(l).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},it={class:"card mb-3"},rt={class:"card-body"},ut={class:"text-muted mt-0"},dt=h("strong",{class:"text-success"},"推荐开启，有利于减少数据库和服务器的负担！",-1),mt=h("br",null,null,-1),pt=h("br",null,null,-1),ft=h("br",null,null,-1),gt={class:"d-inline-flex align-items-center"},bt=h("span",{class:"ms-1"},"Redis 缓存",-1),vt={class:"m-b-20"},ht=h("span",{class:"badge bg-success font-white"}," +30% ",-1),yt={class:"text-muted"},wt=h("strong",{class:"flex-center"},"配置 Redis 缓存服务",-1),xt={class:"row"},_t={class:"col-md-4"},kt={class:"form-group mb-3"},Vt={class:"form-label required"},zt=h("span",{class:"ms-1"},"主机：",-1),St={class:"col-md-4"},jt={class:"form-group mb-3"},Ct={class:"form-label required"},Ut=h("span",{class:"ms-1"},"端口：",-1),Ot={class:"col-md-4"},qt={class:"form-group mb-3"},Rt={class:"form-label required"},Kt=h("span",{class:"ms-1"},"数据库：",-1),It={class:"font-13"},Jt={class:"row"},At={class:"col-md-4"},Nt={class:"form-group mb-3"},Dt={class:"form-label"},$t=h("span",{class:"ms-1"},"密码：",-1),Et={class:"col-md-4"},Pt={class:"form-group mb-3"},Tt={class:"form-label"},Lt=h("span",{class:"ms-1"},"过期时间（秒）：",-1),Mt={class:"col-md-4"},Bt={class:"form-group mb-3"},Wt={class:"form-label"},Xt=h("span",{class:"ms-1"},"前缀：",-1),Ft=h("span",{class:"ms-1"},"测试连接",-1),Ht={__name:"cache-redis",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{open:!1,default:null,host:"localhost",port:6379,database:0,password:"",prefix:"inis:",expire:"2 * 60 * 60"},status:{finish:!1,active:!1,dialog:!1,loading:!0,test:!1},backup:{}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/cache",{name:"redis"});c.status.loading=!1,200===e&&(c.struct=a,c.backup=JSON.parse(JSON.stringify(a)),c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{const{code:t,msg:l}=await s.put("/api/toml/cache-default",{value:"redis",open:e});if(200===t)return o("refresh","cache-file","cache-ram");c.status.active=!e,a.error(l)},save:async()=>{if(!t.object.equal(c.struct,c.backup,["host","port","database","password"]))return a.warn("请先完成测试连接");if(t.is.empty(c.struct.host))return a.warn("请填写 主机地址！");if(t.is.empty(c.struct.port))return a.warn("请填写 端口号！");if(t.is.empty(c.struct.database))return a.warn("请选择 数据库！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/cache-redis",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1},test:async()=>{if(t.is.empty(c.struct.host))return a.warn("请填写 主机地址！");if(t.is.empty(c.struct.port))return a.warn("请填写 端口号！");if(t.is.empty(c.struct.database))return a.warn("请选择 数据库！");c.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-redis",c.struct);if(c.status.test=!1,200===e)return c.backup=JSON.parse(JSON.stringify(c.struct)),a.success(l);a.error(`${l}<br>${n}`)}};return d((()=>c.struct),(()=>{c.status.active="redis"===c.struct.default&&c.struct.open}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-input-number"),r=m("el-option"),u=m("el-select"),d=m("el-button"),_=m("el-dialog"),C=p("loading");return f(),g(z,null,[b((f(),g("div",it,[h("div",rt,[y(a,{name:"redis",color:"rgb(var(--assist-color))",size:"56px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",ut,[y(t,{placement:"top"},{content:w((()=>[dt,mt,x(" 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算，"),pt,x(" 从而提高API的响应速度，减少服务器的负担。"),ft,x(" PS：缓存数据会存储在专门的缓存数据库Redis中。 ")])),default:w((()=>[h("span",gt,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),bt])])),_:1})]),h("h2",vt,[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),ht,h("span",yt,[x(" 综合提升，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[C,v(c).status.loading]]),y(_,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[11]||(s[11]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[wt])),default:w((()=>[h("div",xt,[h("div",_t,[h("div",kt,[h("label",Vt,[y(t,{content:"主机地址，如：localhost",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),zt])])),_:1})]),y(n,{modelValue:v(c).struct.host,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.host=e)},null,8,["modelValue"])])]),h("div",St,[h("div",jt,[h("label",Ct,[y(t,{content:"端口号，如：6379",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ut])])),_:1})]),y(o,{modelValue:v(c).struct.port,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.port=e),min:1,max:65535,class:"w-100 d-flex",style:{height:"28px"},"controls-position":"right"},null,8,["modelValue"])])]),h("div",Ot,[h("div",qt,[h("label",Rt,[y(t,{content:"数据库索引，如：0",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Kt])])),_:1})]),y(u,{modelValue:v(c).struct.database,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.database=e),placeholder:"请选择方式",class:"d-block custom font-13"},{default:w((()=>[(f(),g(z,null,S(16,((e,s)=>y(r,{key:s,label:s,value:s},{default:w((()=>[h("span",It,j(s),1)])),_:2},1032,["label","value"]))),64))])),_:1},8,["modelValue"])])])]),h("div",Jt,[h("div",At,[h("div",Nt,[h("label",Dt,[y(t,{content:"Redis密码，无密码为空即可",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),$t])])),_:1})]),y(n,{modelValue:v(c).struct.password,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).struct.password=e),"show-password":"",placeholder:"无密码为空即可"},null,8,["modelValue"])])]),h("div",Et,[h("div",Pt,[h("label",Tt,[y(t,{content:"缓存有效时间，建议2小时，即7200秒，0表示永不过期",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Lt])])),_:1})]),y(n,{modelValue:v(c).struct.expire,"onUpdate:modelValue":s[6]||(s[6]=e=>v(c).struct.expire=e)},null,8,["modelValue"])])]),h("div",Mt,[h("div",Bt,[h("label",Wt,[y(t,{content:"每个Key固定的前缀，如：inis:",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Xt])])),_:1})]),y(n,{modelValue:v(c).struct.prefix,"onUpdate:modelValue":s[7]||(s[7]=e=>v(c).struct.prefix=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(d,{onClick:s[8]||(s[8]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(d,{onClick:s[9]||(s[9]=e=>i.test()),loading:v(c).status.test},{default:w((()=>[v(c).status.test?V("",!0):(f(),k(a,{key:0,name:"connect",size:"14px"})),Ft])),_:1},8,["loading"]),y(d,{onClick:s[10]||(s[10]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},Yt={class:"card mb-3"},Gt={class:"card-body"},Qt={class:"text-muted mt-0"},Zt=h("strong",{class:"text-success"},"推荐开启，有利于减少数据库和服务器的负担！",-1),el=h("br",null,null,-1),sl=h("br",null,null,-1),al=h("br",null,null,-1),tl=h("code",null,"runtime/cache",-1),ll={class:"d-inline-flex align-items-center"},nl=h("span",{class:"ms-1"},"文件缓存",-1),ol={class:"m-b-20"},cl=h("span",{class:"badge bg-success font-white"}," +20% ",-1),il={class:"text-muted"},rl=h("strong",{class:"flex-center"},"配置 文件 缓存服务",-1),ul={class:"row"},dl={class:"col-md-4"},ml={class:"form-group mb-3"},pl={class:"form-label"},fl=h("span",{class:"ms-1"},"缓存目录：",-1),gl={class:"col-md-4"},bl={class:"form-group mb-3"},vl={class:"form-label"},hl=h("span",{class:"ms-1"},"过期时间（秒）：",-1),yl={class:"col-md-4"},wl={class:"form-group mb-3"},xl={class:"form-label"},_l=h("span",{class:"ms-1"},"前缀：",-1),kl={__name:"cache-file",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{open:!1,default:null,path:null,prefix:"inis_",expire:"2 * 60 * 60"},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/cache",{name:"file"});c.status.loading=!1,200===e&&(c.struct=a,c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{const{code:t,msg:l}=await s.put("/api/toml/cache-default",{value:"file",open:e});if(200===t)return o("refresh","cache-redis","cache-ram");c.status.active=!e,a.error(l)},save:async()=>{if(t.is.empty(c.struct.path))return a.warn("请填写 缓存目录！");if(t.is.empty(c.struct.expire))return a.warn("请填写 过期时间！");if(t.is.empty(c.struct.prefix))return a.warn("请选择 缓存前缀！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/cache-file",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1}};return d((()=>c.struct),(()=>{c.status.active="file"===c.struct.default&&c.struct.open}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-button"),r=m("el-dialog"),u=p("loading");return f(),g(z,null,[b((f(),g("div",Yt,[h("div",Gt,[y(a,{name:"file",color:"rgb(var(--assist-color))",size:"55px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Qt,[y(t,{placement:"top"},{content:w((()=>[Zt,el,x(" 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算，"),sl,x(" 从而提高API的响应速度，减少服务器的负担。"),al,x(" PS：缓存数据会通过文件的方式存储在服务器的 "),tl,x(" 目录下。 ")])),default:w((()=>[h("span",ll,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),nl])])),_:1})]),h("h2",ol,[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),cl,h("span",il,[x(" 综合提升，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[u,v(c).status.loading]]),y(r,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[7]||(s[7]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[rl])),default:w((()=>[h("div",ul,[h("div",dl,[h("div",ml,[h("label",pl,[y(t,{content:"缓存文件存储到哪个目录下？推荐：runtime/cache",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),fl])])),_:1})]),y(n,{modelValue:v(c).struct.path,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.path=e),placeholder:"缓存目录"},null,8,["modelValue"])])]),h("div",gl,[h("div",bl,[h("label",vl,[y(t,{content:"缓存有效时间，建议2小时，即7200秒，0表示永不过期",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),hl])])),_:1})]),y(n,{modelValue:v(c).struct.expire,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.expire=e)},null,8,["modelValue"])])]),h("div",yl,[h("div",wl,[h("label",xl,[y(t,{content:"每个Key固定的前缀，推荐：inis_",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),_l])])),_:1})]),y(n,{modelValue:v(c).struct.prefix,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.prefix=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(o,{onClick:s[5]||(s[5]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(o,{onClick:s[6]||(s[6]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},Vl={class:"card mb-3"},zl={class:"card-body"},Sl={class:"text-muted mt-0"},jl=h("strong",{class:"text-success"},"推荐开启，有利于减少数据库和服务器的负担！",-1),Cl=h("br",null,null,-1),Ul=h("br",null,null,-1),Ol=h("br",null,null,-1),ql={class:"d-inline-flex align-items-center"},Rl=h("span",{class:"ms-1"},"内存缓存",-1),Kl={class:"m-b-20"},Il=h("span",{class:"badge bg-success font-white"}," +20% ",-1),Jl={class:"text-muted"},Al=h("strong",{class:"flex-center"},"配置 内存 缓存服务",-1),Nl={class:"row"},Dl={class:"col-md-12"},$l={class:"form-group mb-3"},El={class:"form-label"},Pl=h("span",{class:"ms-1"},"过期时间（秒）：",-1),Tl={__name:"cache-ram",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{open:!1,default:null,expire:"2 * 60 * 60"},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/cache",{name:"ram"});c.status.loading=!1,200===e&&(c.struct=a,c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{const{code:t,msg:l}=await s.put("/api/toml/cache-default",{value:"ram",open:e});if(200===t)return o("refresh","cache-redis","cache-file");c.status.active=!e,a.error(l)},save:async()=>{if(t.is.empty(c.struct.expire))return a.warn("请填写 过期时间！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/cache-ram",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1}};return d((()=>c.struct),(()=>{c.status.active="ram"===c.struct.default&&c.struct.open}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-button"),r=m("el-dialog"),u=p("loading");return f(),g(z,null,[b((f(),g("div",Vl,[h("div",zl,[y(a,{name:"ram",color:"rgb(var(--assist-color))",size:"55px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Sl,[y(t,{placement:"top"},{content:w((()=>[jl,Cl,x(" 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算，"),Ul,x(" 从而提高API的响应速度，减少服务器的负担。"),Ol,x(" PS：缓存数据会通过内存的方式存储在服务器的内存中。 ")])),default:w((()=>[h("span",ql,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),Rl])])),_:1})]),h("h2",Kl,[y(t,{content:"请不要作死，内存很宝贵，不要用在这种地方，除非你是本地环境或者不怕死",placement:"top"},{default:w((()=>[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:"","active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange"])])),_:1})]),Il,h("span",Jl,[x(" 综合提升，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[u,v(c).status.loading]]),y(r,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[Al])),default:w((()=>[h("div",Nl,[h("div",Dl,[h("div",$l,[h("label",El,[y(t,{content:"缓存有效时间，建议2小时，即7200秒，0表示永不过期",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Pl])])),_:1})]),y(n,{modelValue:v(c).struct.expire,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.expire=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(o,{onClick:s[3]||(s[3]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(o,{onClick:s[4]||(s[4]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},Ll={class:"card mb-3"},Ml={class:"card-body"},Bl={class:"text-muted text-uppercase mt-0"},Wl=h("br",null,null,-1),Xl={class:"d-inline-flex align-items-center"},Fl=h("span",{class:"ms-1"},"本地存储",-1),Hl={class:"m-b-20"},Yl=h("span",{class:"badge bg-dark font-white"}," 传统 ",-1),Gl={class:"text-muted ms-1"},Ql=h("strong",{class:"flex-center"},"配置本地存储",-1),Zl={class:"row"},en={class:"col-6"},sn={class:"form-group mb-3"},an={class:"form-label required"},tn=h("span",{class:"ms-1"},"域名：",-1),ln={class:"col-md-6"},nn={class:"form-group mb-3"},on={class:"form-label"},cn=h("span",{class:"ms-1"},"存储目录：",-1),rn={__name:"storage-local",emits:["refresh"],setup(e,{expose:t,emit:l}){const n=l,o=r({struct:{default:null,domain:null,path:"storage"},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1}});u((async()=>{await c.init()}));const c={init:async()=>{o.status.finish=!1,o.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/storage",{name:"local"});o.status.loading=!1,200===e&&(o.struct=a,o.status.finish=!0)},show(){if(!o.status.finish)return a.warn("配置获取失败，无法进行配置！");o.status.dialog=!0},change:async e=>{if(!e)return o.status.active=!0;const{code:t,msg:l}=await s.put("/api/toml/storage-default",{value:e?"local":null});if(200===t)return n("refresh");o.status.active=!e,a.error(l)},save:async()=>{o.status.wait=!0;const{code:e,msg:t}=await s.put("/api/toml/storage-local",o.struct);if(o.status.wait=!1,200!==e)return a.error("保存失败："+t);o.status.dialog=!1}};return d((()=>o.struct),(()=>{o.status.active="local"===o.struct.default}),{deep:!0}),t({init:c.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),i=m("el-button"),r=m("el-dialog"),u=p("loading");return f(),g(z,null,[b((f(),g("div",Ll,[h("div",Ml,[y(a,{name:"serve",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Bl,[y(t,{placement:"top"},{content:w((()=>[x(" ● 本地存储是指将图片等资源文件存储到服务器本地，然后通过访问服务器的方式获取资源文件"),Wl,x(" ● 本地存储的优点是不花钱，缺点是占用服务器空间和带宽 ")])),default:w((()=>[h("span",Xl,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),Fl])])),_:1})]),h("h2",Hl,[y(l,{modelValue:v(o).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(o).status.active=e),onChange:c.change,disabled:!v(o).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),Yl,h("span",Gl,[x(" 这个不花钱，"),h("span",{onClick:s[1]||(s[1]=e=>c.show()),class:"text-dark pointer"},"点我配置")])])])),[[u,v(o).status.loading]]),y(r,{modelValue:v(o).status.dialog,"onUpdate:modelValue":s[6]||(s[6]=e=>v(o).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[Ql])),default:w((()=>[h("div",Zl,[h("div",en,[h("div",sn,[h("label",an,[y(t,{content:"自定义存储域名",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),tn])])),_:1})]),y(n,{modelValue:v(o).struct.domain,"onUpdate:modelValue":s[2]||(s[2]=e=>v(o).struct.domain=e)},null,8,["modelValue"])])]),h("div",ln,[h("div",nn,[h("label",on,[y(t,{content:"存储在哪个目录下",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),cn])])),_:1})]),y(n,{modelValue:v(o).struct.path,"onUpdate:modelValue":s[3]||(s[3]=e=>v(o).struct.path=e),placeholder:"如: storage"},null,8,["modelValue"])])])])])),footer:w((()=>[y(i,{onClick:s[4]||(s[4]=e=>v(o).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(i,{onClick:s[5]||(s[5]=e=>c.save()),loading:v(o).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},un={class:"card mb-3"},dn={class:"card-body"},mn={class:"text-muted text-uppercase mt-0"},pn=h("br",null,null,-1),fn={class:"d-inline-flex align-items-center"},gn=h("span",{class:"ms-1"},"OSS",-1),bn={class:"m-b-20"},vn=h("span",{class:"badge bg-warning font-white"}," 推荐 ",-1),hn={class:"text-muted ms-1"},yn=h("strong",{class:"flex-center"},"配置 阿里云OSS 存储",-1),wn={class:"row"},xn={class:"col-md-6"},_n={class:"form-group mb-3"},kn={class:"form-label required"},Vn=h("span",{class:"ms-1"},"AccessKey ID：",-1),zn={class:"col-md-6"},Sn={class:"form-group mb-3"},jn={class:"form-label required"},Cn=h("span",{class:"ms-1"},"AccessKey Secret：",-1),Un={class:"col-md-4"},On={class:"form-group mb-3"},qn={class:"form-label required"},Rn=h("span",{class:"ms-1"},"Endpoint：",-1),Kn={class:"font-13"},In={class:"text-muted float-end"},Jn={class:"col-md-4"},An={class:"form-group mb-3"},Nn={class:"form-label required"},Dn=h("span",{class:"ms-1"},"OSS Bucket：",-1),$n={class:"col-md-4"},En={class:"form-group mb-3"},Pn={class:"form-label"},Tn=h("span",{class:"ms-1"},"存储目录：",-1),Ln={class:"col-md-12"},Mn={class:"form-group mb-3"},Bn={class:"form-label"},Wn=h("span",{class:"ms-1"},"OSS 外网域名：",-1),Xn=h("span",{class:"ms-1"},"测试连接",-1),Fn={__name:"storage-oss",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{path:"inis",default:null,domain:null,bucket:null,endpoint:null,access_key_id:null,access_key_secret:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{},select:{endpoint:[{value:"oss-cn-hangzhou.aliyuncs.com",label:"华东1（杭州）"},{value:"oss-cn-shanghai.aliyuncs.com",label:"华东2（上海）"},{value:"oss-cn-nanjing.aliyuncs.com",label:"华东5（南京-本地地域）"},{value:"oss-cn-fuzhou.aliyuncs.com",label:"华东6（福州-本地地域）"},{value:"oss-cn-qingdao.aliyuncs.com",label:"华北1（青岛）"},{value:"oss-cn-beijing.aliyuncs.com",label:"华北2（北京）"},{value:"oss-cn-zhangjiakou.aliyuncs.com",label:"华北 3（张家口）"},{value:"oss-cn-huhehaote.aliyuncs.com",label:"华北5（呼和浩特）"},{value:"oss-cn-wulanchabu.aliyuncs.com",label:"华北6（乌兰察布）"},{value:"oss-cn-shenzhen.aliyuncs.com",label:"华南1（深圳）"},{value:"oss-cn-heyuan.aliyuncs.com",label:"华南2（河源）"},{value:"oss-cn-guangzhou.aliyuncs.com",label:"华南3（广州）"},{value:"oss-cn-chengdu.aliyuncs.com",label:"西南1（成都）"},{value:"oss-cn-hongkong.aliyuncs.com",label:"中国香港"},{value:"oss-us-west-1.aliyuncs.com",label:"美国（硅谷）①"},{value:"oss-us-east-1.aliyuncs.com",label:"美国（弗吉尼亚）①"},{value:"oss-ap-northeast-1.aliyuncs.com",label:"日本（东京）①"},{value:"oss-ap-northeast-2.aliyuncs.com",label:"韩国（首尔）"},{value:"oss-ap-southeast-1.aliyuncs.com",label:"新加坡①"},{value:"oss-ap-southeast-2.aliyuncs.com",label:"澳大利亚（悉尼）①"},{value:"oss-ap-southeast-3.aliyuncs.com",label:"马来西亚（吉隆坡）①"},{value:"oss-ap-southeast-5.aliyuncs.com",label:"印度尼西亚（雅加达）①"},{value:"oss-ap-southeast-6.aliyuncs.com",label:"菲律宾（马尼拉）"},{value:"oss-ap-southeast-7.aliyuncs.com",label:"泰国（曼谷）"},{value:"oss-ap-south-1.aliyuncs.com",label:"印度（孟买）①"},{value:"oss-eu-central-1.aliyuncs.com",label:"德国（法兰克福）①"},{value:"oss-eu-west-1.aliyuncs.com",label:"英国（伦敦）"},{value:"oss-me-east-1.aliyuncs.com",label:"阿联酋（迪拜）①"},{value:"oss-rg-china-mainland.aliyuncs.com",label:"无地域属性（中国内地）"},{value:"oss-cn-hzfinance.aliyuncs.com",label:"杭州金融云公网"},{value:"oss-cn-shanghai-finance-1-pub.aliyuncs.com",label:"上海金融云公网"},{value:"oss-cn-szfinance.aliyuncs.com",label:"深圳金融云公网"},{value:"oss-cn-beijing-finance-1-pub.aliyuncs.com",label:"北京金融云公网"}]}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/storage",{name:"oss"});c.status.loading=!1,200===e&&(c.struct=a,c.backup=JSON.parse(JSON.stringify(a)),c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("存储配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{if(!e)return c.status.active=!0;const{code:t,msg:l}=await s.put("/api/toml/storage-default",{value:e?"oss":null});if(200===t)return o("refresh");c.status.active=!e,a.error(l)},save:async()=>{if(!t.object.equal(c.struct,c.backup,["access_key_id","access_key_secret","endpoint","bucket"]))return a.warn("请先OSS连接测试");if(t.is.empty(c.struct.access_key_id))return a.warn("请填写 AccessKey ID！");if(t.is.empty(c.struct.access_key_secret))return a.warn("请填写 AccessKey Secret！");if(t.is.empty(c.struct.endpoint))return a.warn("请填写 Endpoint！");if(t.is.empty(c.struct.bucket))return a.warn("请填写 Bucket！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/storage-oss",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1},test:async()=>{if(t.is.empty(c.struct.access_key_id))return a.warn("请填写 AccessKey ID！");if(t.is.empty(c.struct.access_key_secret))return a.warn("请填写 AccessKey Secret！");if(t.is.empty(c.struct.endpoint))return a.warn("请填写 Endpoint！");if(t.is.empty(c.struct.bucket))return a.warn("请填写 Bucket！");c.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-oss",c.struct);if(c.status.test=!1,200===e)return c.backup=JSON.parse(JSON.stringify(c.struct)),a.success(l);a.error(`${l}<br>${n}`)}};return d((()=>c.struct),(()=>{c.status.active="oss"===c.struct.default}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-option"),r=m("el-select"),u=m("el-button"),d=m("el-dialog"),_=p("loading");return f(),g(z,null,[b((f(),g("div",un,[h("div",dn,[y(a,{name:"aliyun",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",mn,[y(t,{placement:"top"},{content:w((()=>[x(" ● OSS可以替代传统的本地存储，有能力的情况推荐开启OSS存储"),pn,x(" ● 开启后，后续上传的文件将会自动上传到OSS，不会占用服务器的空间和带宽 ")])),default:w((()=>[h("span",fn,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),gn])])),_:1})]),h("h2",bn,[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),vn,h("span",hn,[x(" 这个还不错，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[_,v(c).status.loading]]),y(d,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[11]||(s[11]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[yn])),default:w((()=>[h("div",wn,[h("div",xn,[h("div",_n,[h("label",kn,[y(t,{content:"阿里云 AccessKey ID",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Vn])])),_:1})]),y(n,{modelValue:v(c).struct.access_key_id,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.access_key_id=e),"show-password":""},null,8,["modelValue"])])]),h("div",zn,[h("div",Sn,[h("label",jn,[y(t,{content:"阿里云AccessKey Secret",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Cn])])),_:1})]),y(n,{modelValue:v(c).struct.access_key_secret,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.access_key_secret=e),"show-password":""},null,8,["modelValue"])])]),h("div",Un,[h("div",On,[h("label",qn,[y(t,{content:"OSS 外网 Endpoint",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Rn])])),_:1})]),y(r,{modelValue:v(c).struct.endpoint,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.endpoint=e),placeholder:"请选择所在地区",class:"d-block custom font-13"},{default:w((()=>[(f(!0),g(z,null,S(v(c).select.endpoint,(e=>(f(),k(o,{key:e.value,label:e.label,value:e.value},{default:w((()=>[h("span",Kn,j(e.label),1),h("small",In,j(e.value),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])]),h("div",Jn,[h("div",An,[h("label",Nn,[y(t,{content:"存储桶名称",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Dn])])),_:1})]),y(n,{modelValue:v(c).struct.bucket,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).struct.bucket=e)},null,8,["modelValue"])])]),h("div",$n,[h("div",En,[h("label",Pn,[y(t,{content:"存储在哪个目录下",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Tn])])),_:1})]),y(n,{modelValue:v(c).struct.path,"onUpdate:modelValue":s[6]||(s[6]=e=>v(c).struct.path=e),placeholder:"如: inis"},null,8,["modelValue"])])]),h("div",Ln,[h("div",Mn,[h("label",Bn,[y(t,{content:"用于访问 - 不填写则使用默认域名",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Wn])])),_:1})]),y(n,{modelValue:v(c).struct.domain,"onUpdate:modelValue":s[7]||(s[7]=e=>v(c).struct.domain=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(u,{onClick:s[8]||(s[8]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(u,{onClick:s[9]||(s[9]=e=>i.test()),loading:v(c).status.test},{default:w((()=>[v(c).status.test?V("",!0):(f(),k(a,{key:0,name:"connect",size:"14px"})),Xn])),_:1},8,["loading"]),y(u,{onClick:s[10]||(s[10]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},Hn={class:"card mb-3"},Yn={class:"card-body"},Gn={class:"text-muted text-uppercase mt-0"},Qn=h("br",null,null,-1),Zn={class:"d-inline-flex align-items-center"},eo=h("span",{class:"ms-1"},"COS",-1),so={class:"m-b-20"},ao=h("span",{class:"badge bg-primary font-white"}," 推荐 ",-1),to={class:"text-muted ms-1"},lo=h("strong",{class:"flex-center"},"配置 腾讯云COS 存储",-1),no={class:"row"},oo={class:"col-md-6"},co={class:"form-group mb-3"},io={class:"form-label required"},ro=h("span",{class:"ms-1"},"SecretId：",-1),uo={class:"col-md-6"},mo={class:"form-group mb-3"},po={class:"form-label required"},fo=h("span",{class:"ms-1"},"SecretKey：",-1),go={class:"col-md-6"},bo={class:"form-group mb-3"},vo={class:"form-label required"},ho=h("span",{class:"ms-1"},"AppId：",-1),yo={class:"col-md-6"},wo={class:"form-group mb-3"},xo={class:"form-label required"},_o=h("span",{class:"ms-1"},"COS Bucket：",-1),ko={class:"col-md-3"},Vo={class:"form-group mb-3"},zo={class:"form-label required"},So=h("span",{class:"ms-1"},"COS Region：",-1),jo={class:"font-13"},Co={class:"text-muted float-end"},Uo={class:"col-md-3"},Oo={class:"form-group mb-3"},qo={class:"form-label"},Ro=h("span",{class:"ms-1"},"存储目录：",-1),Ko={class:"col-md-6"},Io={class:"form-group mb-3"},Jo={class:"form-label"},Ao=h("span",{class:"ms-1"},"COS 外网域名：",-1),No=h("span",{class:"ms-1"},"测试连接",-1),Do={__name:"storage-cos",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{path:"inis",default:null,domain:null,app_id:null,bucket:null,region:null,secret_id:null,secret_key:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{},select:{region:[{value:"ap-beijing-1",label:"北京一区",area:"中国大陆"},{value:"ap-beijing",label:"北京",area:"中国大陆"},{value:"ap-nanjing",label:"南京",area:"中国大陆"},{value:"ap-shanghai",label:"上海",area:"中国大陆"},{value:"ap-guangzhou",label:"广州",area:"中国大陆"},{value:"ap-chengdu",label:"成都",area:"中国大陆"},{value:"ap-chongqing",label:"重庆",area:"中国大陆"},{value:"ap-shenzhen-fsi",label:"深圳金融",area:"中国大陆"},{value:"ap-shanghai-fsi",label:"上海金融",area:"中国大陆"},{value:"ap-beijing-fsi",label:"北京金融",area:"中国大陆"},{value:"ap-hongkong",label:"中国香港",area:"亚太"},{value:"ap-singapore",label:"新加坡",area:"亚太"},{value:"ap-mumbai",label:"孟买",area:"亚太"},{value:"ap-jakarta",label:"雅加达",area:"亚太"},{value:"ap-seoul",label:"首尔",area:"亚太"},{value:"ap-bangkok",label:"曼谷",area:"亚太"},{value:"ap-tokyo",label:"东京",area:"亚太"},{value:"na-siliconvalley",label:"硅谷（美西）",area:"北美"},{value:"na-ashburn",label:"弗吉尼亚（美东）",area:"北美"},{value:"na-toronto",label:"多伦多",area:"北美"},{value:"sa-saopaulo",label:"圣保罗",area:"南美"},{value:"eu-frankfurt",label:"法兰克福",area:"欧洲"}]}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/storage",{name:"cos"});c.status.loading=!1,200===e&&(c.struct=a,c.backup=JSON.parse(JSON.stringify(a)),c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{if(!e)return c.status.active=!0;const{code:t,msg:l}=await s.put("/api/toml/storage-default",{value:e?"cos":null});if(200===t)return o("refresh");c.status.active=!e,a.error(l)},save:async()=>{if(!t.object.equal(c.struct,c.backup,["secret_id","secret_key","app_id","region","bucket"]))return a.warn("请先OSS连接测试");if(t.is.empty(c.struct.secret_id))return a.warn("请填写 SecretId！");if(t.is.empty(c.struct.secret_key))return a.warn("请填写 SecretKey！");if(t.is.empty(c.struct.app_id))return a.warn("请填写 AppId！");if(t.is.empty(c.struct.region))return a.warn("请填写 Bucket！");if(t.is.empty(c.struct.bucket))return a.warn("请填写 Region！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/storage-cos",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1},test:async()=>{if(t.is.empty(c.struct.secret_id))return a.warn("请填写 SecretId！");if(t.is.empty(c.struct.secret_key))return a.warn("请填写 SecretKey！");if(t.is.empty(c.struct.app_id))return a.warn("请填写 AppId！");if(t.is.empty(c.struct.region))return a.warn("请填写 Bucket！");if(t.is.empty(c.struct.bucket))return a.warn("请填写 Region！");c.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-cos",c.struct);if(c.status.test=!1,200===e)return c.backup=JSON.parse(JSON.stringify(c.struct)),a.success(l);a.error(`${l}<br>${n}`)}};return d((()=>c.struct),(()=>{c.status.active="cos"===c.struct.default}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("el-switch"),n=m("el-input"),o=m("el-option"),r=m("el-select"),u=m("el-button"),d=m("el-dialog"),_=p("loading");return f(),g(z,null,[b((f(),g("div",Hn,[h("div",Yn,[y(a,{name:"tencent",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Gn,[y(t,{placement:"top"},{content:w((()=>[x(" ● COS可以替代传统的本地存储，有能力的情况推荐开启COS存储"),Qn,x(" ● 开启后，后续上传的文件将会自动上传到COS，不会占用服务器的空间和带宽 ")])),default:w((()=>[h("span",Zn,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),eo])])),_:1})]),h("h2",so,[y(l,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),ao,h("span",to,[x(" 这个也不错，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[_,v(c).status.loading]]),y(d,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[12]||(s[12]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[lo])),default:w((()=>[h("div",no,[h("div",oo,[h("div",co,[h("label",io,[y(t,{content:"腾讯云COS SecretId",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ro])])),_:1})]),y(n,{modelValue:v(c).struct.secret_id,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.secret_id=e),"show-password":""},null,8,["modelValue"])])]),h("div",uo,[h("div",mo,[h("label",po,[y(t,{content:"腾讯云COS SecretKey",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),fo])])),_:1})]),y(n,{modelValue:v(c).struct.secret_key,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.secret_key=e),"show-password":""},null,8,["modelValue"])])]),h("div",go,[h("div",bo,[h("label",vo,[y(t,{content:"腾讯云COS AppId",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),ho])])),_:1})]),y(n,{modelValue:v(c).struct.app_id,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.app_id=e)},null,8,["modelValue"])])]),h("div",yo,[h("div",wo,[h("label",xo,[y(t,{content:"存储桶名称",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),_o])])),_:1})]),y(n,{modelValue:v(c).struct.bucket,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).struct.bucket=e)},null,8,["modelValue"])])]),h("div",ko,[h("div",Vo,[h("label",zo,[y(t,{content:"所在地区，如这里的 ap-guangzhou（广州）",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),So])])),_:1})]),y(r,{modelValue:v(c).struct.region,"onUpdate:modelValue":s[6]||(s[6]=e=>v(c).struct.region=e),placeholder:"请选择所在地区",class:"d-block custom font-13"},{default:w((()=>[(f(!0),g(z,null,S(v(c).select.region,(e=>(f(),k(o,{key:e.value,label:e.label,value:e.value},{default:w((()=>[h("span",jo,j(e.label),1),h("small",Co,j(e.value)+" | "+j(e.area),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])]),h("div",Uo,[h("div",Oo,[h("label",qo,[y(t,{content:"存储在哪个目录下",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ro])])),_:1})]),y(n,{modelValue:v(c).struct.path,"onUpdate:modelValue":s[7]||(s[7]=e=>v(c).struct.path=e),placeholder:"如: inis"},null,8,["modelValue"])])]),h("div",Ko,[h("div",Io,[h("label",Jo,[y(t,{content:"用于访问 - 不填写则使用默认域名",placement:"top"},{default:w((()=>[h("span",null,[y(a,{name:"hint",size:"14px"}),Ao])])),_:1})]),y(n,{modelValue:v(c).struct.domain,"onUpdate:modelValue":s[8]||(s[8]=e=>v(c).struct.domain=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(u,{onClick:s[9]||(s[9]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(u,{onClick:s[10]||(s[10]=e=>i.test()),loading:v(c).status.test},{default:w((()=>[v(c).status.test?V("",!0):(f(),k(a,{key:0,name:"connect",size:"14px"})),No])),_:1},8,["loading"]),y(u,{onClick:s[11]||(s[11]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},$o={class:"card mb-3"},Eo={class:"card-body"},Po={class:"text-muted text-uppercase mt-0"},To=h("br",null,null,-1),Lo={class:"d-inline-flex align-items-center"},Mo=h("span",{class:"ms-1"},"KODO",-1),Bo={class:"m-b-20"},Wo=h("span",{class:"badge bg-info font-white"}," 一般 ",-1),Xo={class:"text-muted ms-1"},Fo=h("strong",{class:"flex-center"},"配置 七牛云KODO 存储",-1),Ho={class:"row"},Yo={class:"col-md-6"},Go={class:"form-group mb-3"},Qo={class:"form-label required"},Zo=h("span",{class:"ms-1"},"AccessKey：",-1),ec={class:"col-md-6"},sc={class:"form-group mb-3"},ac={class:"form-label required"},tc=h("span",{class:"ms-1"},"SecretKey：",-1),lc={class:"col-md-6"},nc={class:"form-group mb-3"},oc={class:"form-label required"},cc=h("span",{class:"ms-1"},"Bucket：",-1),ic={class:"col-md-6"},rc={class:"form-group mb-3"},uc={class:"form-label required"},dc=h("span",{class:"ms-1"},"Region：",-1),mc={class:"font-13"},pc={class:"text-muted float-end"},fc={class:"col-md-12"},gc={class:"form-group mb-3"},bc={class:"form-label required"},vc=h("span",{class:"ms-1"},"外网域名：",-1),hc=h("span",{class:"ms-1"},"测试连接",-1),yc={__name:"storage-kodo",emits:["refresh"],setup(e,{expose:l,emit:n}){const o=n,c=r({struct:{default:null,domain:null,access_key:null,secret_key:null,bucket:null,region:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{},select:{region:[{value:"z0",label:"华东"},{value:"z1",label:"华北河北"},{value:"z2",label:"华南广东"},{value:"na0",label:"北美"},{value:"as0",label:"新加坡"},{value:"cn-east-2",label:"华东浙江"},{value:"ap-northeast-1",label:"亚太-首尔机房"}]}});u((async()=>{await i.init()}));const i={init:async()=>{c.status.finish=!1,c.status.loading=!0;const{code:e,data:a}=await s.get("/api/toml/storage",{name:"kodo"});c.status.loading=!1,200===e&&(c.struct=a,c.backup=JSON.parse(JSON.stringify(a)),c.status.finish=!0)},show(){if(!c.status.finish)return a.warn("配置获取失败，无法进行配置！");c.status.dialog=!0},change:async e=>{if(!e)return c.status.active=!0;const{code:t,msg:l}=await s.put("/api/toml/storage-default",{value:e?"kodo":null});if(200===t)return o("refresh");c.status.active=!e,a.error(l)},save:async()=>{if(!t.object.equal(c.struct,c.backup,["access_key","secret_key","bucket","region"]))return a.warn("请先KODO连接测试");if(t.is.empty(c.struct.access_key))return a.warn("请填写 AccessKey！");if(t.is.empty(c.struct.secret_key))return a.warn("请填写 SecretKey！");if(t.is.empty(c.struct.bucket))return a.warn("请填写 Bucket！");if(t.is.empty(c.struct.region))return a.warn("请填写 Region！");if(t.is.empty(c.struct.domain))return a.warn("请填写 外网域名！");c.status.wait=!0;const{code:e,msg:l}=await s.put("/api/toml/storage-kodo",c.struct);if(c.status.wait=!1,200!==e)return a.error("保存失败："+l);c.status.dialog=!1},test:async()=>{if(t.is.empty(c.struct.access_key))return a.warn("请填写 AccessKey！");if(t.is.empty(c.struct.secret_key))return a.warn("请填写 SecretKey！");if(t.is.empty(c.struct.bucket))return a.warn("请填写 Bucket！");if(t.is.empty(c.struct.region))return a.warn("请填写 Region！");c.status.test=!0;const{code:e,msg:l,data:n}=await s.post("/api/toml/test-kodo",c.struct);if(c.status.test=!1,200===e)return c.backup=JSON.parse(JSON.stringify(c.struct)),a.success(l);a.error(`${l}<br>${n}`)}};return d((()=>c.struct),(()=>{c.status.active="kodo"===c.struct.default}),{deep:!0}),l({init:i.init}),(e,s)=>{const a=m("el-image"),t=m("i-svg"),l=m("el-tooltip"),n=m("el-switch"),o=m("el-input"),r=m("el-option"),u=m("el-select"),d=m("el-button"),_=m("el-dialog"),C=p("loading");return f(),g(z,null,[b((f(),g("div",$o,[h("div",Eo,[y(a,{src:"/assets/imgs/png/qiniu.png",class:"position-absolute opacity-25",style:{right:"1.5rem",height:"65px"}}),h("h6",Po,[y(l,{placement:"top"},{content:w((()=>[x(" ● KODO可以替代传统的本地存储，有能力的情况推荐开启KODO存储（但是总体体验上比OSS和COS略差）"),To,x(" ● 开启后，后续上传的文件将会自动上传到KODO，不会占用服务器的空间和带宽 ")])),default:w((()=>[h("span",Lo,[y(t,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),Mo])])),_:1})]),h("h2",Bo,[y(n,{modelValue:v(c).status.active,"onUpdate:modelValue":s[0]||(s[0]=e=>v(c).status.active=e),onChange:i.change,disabled:!v(c).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),Wo,h("span",Xo,[x(" 不是很好用，"),h("span",{onClick:s[1]||(s[1]=e=>i.show()),class:"text-dark pointer"},"点我配置")])])])),[[C,v(c).status.loading]]),y(_,{modelValue:v(c).status.dialog,"onUpdate:modelValue":s[10]||(s[10]=e=>v(c).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[Fo])),default:w((()=>[h("div",Ho,[h("div",Yo,[h("div",Go,[h("label",Qo,[y(l,{content:"七牛云AccessKey",placement:"top"},{default:w((()=>[h("span",null,[y(t,{name:"hint",size:"14px"}),Zo])])),_:1})]),y(o,{modelValue:v(c).struct.access_key,"onUpdate:modelValue":s[2]||(s[2]=e=>v(c).struct.access_key=e),"show-password":""},null,8,["modelValue"])])]),h("div",ec,[h("div",sc,[h("label",ac,[y(l,{content:"七牛云SecretKey",placement:"top"},{default:w((()=>[h("span",null,[y(t,{name:"hint",size:"14px"}),tc])])),_:1})]),y(o,{modelValue:v(c).struct.secret_key,"onUpdate:modelValue":s[3]||(s[3]=e=>v(c).struct.secret_key=e),"show-password":""},null,8,["modelValue"])])]),h("div",lc,[h("div",nc,[h("label",oc,[y(l,{content:"存储桶名称",placement:"top"},{default:w((()=>[h("span",null,[y(t,{name:"hint",size:"14px"}),cc])])),_:1})]),y(o,{modelValue:v(c).struct.bucket,"onUpdate:modelValue":s[4]||(s[4]=e=>v(c).struct.bucket=e)},null,8,["modelValue"])])]),h("div",ic,[h("div",rc,[h("label",uc,[y(l,{content:"KODO 所在地区",placement:"top"},{default:w((()=>[h("span",null,[y(t,{name:"hint",size:"14px"}),dc])])),_:1})]),y(u,{modelValue:v(c).struct.region,"onUpdate:modelValue":s[5]||(s[5]=e=>v(c).struct.region=e),placeholder:"请选择所在地区",class:"d-block custom font-13"},{default:w((()=>[(f(!0),g(z,null,S(v(c).select.region,(e=>(f(),k(r,{key:e.value,label:e.label,value:e.value},{default:w((()=>[h("span",mc,j(e.label),1),h("small",pc,j(e.value),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])]),h("div",fc,[h("div",gc,[h("label",bc,[y(l,{content:"（必须）外网域名 - 用于访问",placement:"top"},{default:w((()=>[h("span",null,[y(t,{name:"hint",size:"14px"}),vc])])),_:1})]),y(o,{modelValue:v(c).struct.domain,"onUpdate:modelValue":s[6]||(s[6]=e=>v(c).struct.domain=e)},null,8,["modelValue"])])])])])),footer:w((()=>[y(d,{onClick:s[7]||(s[7]=e=>v(c).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(d,{onClick:s[8]||(s[8]=e=>i.test()),loading:v(c).status.test},{default:w((()=>[v(c).status.test?V("",!0):(f(),k(t,{key:0,name:"connect",size:"14px"})),hc])),_:1},8,["loading"]),y(d,{onClick:s[9]||(s[9]=e=>i.save()),loading:v(c).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},wc={class:"card-body"},xc={class:"text-muted text-uppercase mt-0"},_c={class:"d-inline-flex align-items-center"},kc=h("span",{class:"ms-1"},"站点信息",-1),Vc={class:"d-flex"},zc={class:"d-flex align-items-center justify-content-center position-relative",style:{width:"60px",height:"60px"}},Sc={class:"d-flex flex-column justify-content-center ms-2"},jc={class:"font-18 text-dark d-flex align-items-center"},Cc={class:"text-dark font-16 me-2 limit-1-line"},Uc={class:"text-secondary limit-2-line"},Oc=h("strong",{class:"flex-center"},"站 点 信 息 配 置",-1),qc={class:"row"},Rc={class:"col-md-6"},Kc={class:"form-group mb-3"},Ic={class:"form-label"},Jc=h("span",{class:"ms-1"},"ICP 备案码：",-1),Ac={class:"col-md-6"},Nc={class:"form-group mb-3"},Dc={class:"form-label"},$c=h("span",{class:"ms-1"},"ICP 备案链接：",-1),Ec={class:"col-md-6"},Pc={class:"form-group mb-3"},Tc={class:"form-label"},Lc=h("span",{class:"ms-1"},"公安备案码：",-1),Mc={class:"col-md-6"},Bc={class:"form-group mb-3"},Wc={class:"form-label"},Xc=h("span",{class:"ms-1"},"公安备案链接：",-1),Fc={class:"col-md-6"},Hc={class:"form-group mb-3"},Yc={class:"form-label"},Gc=h("span",{class:"ms-1"},"站点头像：",-1),Qc=h("span",{class:"ms-1"},"上传",-1),Zc={class:"col-md-6"},ei={class:"form-group mb-3"},si={class:"form-label"},ai=h("span",{class:"ms-1"},"favicon：",-1),ti=h("span",{class:"ms-1"},"上传",-1),li={class:"col-md-4"},ni={class:"form-group mb-3"},oi={class:"form-label"},ci=h("span",{class:"ms-1"},"站点标题：",-1),ii={class:"col-md-4"},ri={class:"form-group mb-3"},ui={class:"form-label"},di=h("span",{class:"ms-1"},"关键词：",-1),mi={class:"col-md-4"},pi={class:"form-group mb-3"},fi={class:"form-label"},gi=h("span",{class:"ms-1"},"运营时间：",-1),bi={class:"row"},vi={class:"col-lg-12"},hi={class:"form-group mb-3"},yi={class:"form-label"},wi=h("span",{class:"ms-1"},"站点描述：",-1),xi={__name:"site-info",setup(e,{expose:n}){const o=r({item:{avatar:!0,keyword:""},struct:{key:"SITE_INFO",json:{title:"",avatar:"",favicon:"",copy:{code:"",link:""},police:{code:"",link:""},date:"",keyword:"",description:""},remark:"站点信息"},status:{finish:!1,loading:!0,dialog:!1},upload:{avatar:!1,favicon:!1}});u((async()=>{await c.init()}));const c={init:async()=>{o.status.finish=!1,o.status.loading=!0;const{code:e,data:a}=await s.get("/api/config/one",{key:"SITE_INFO"});if(o.status.loading=!1,204===e)return c.save();200===e&&(o.struct=t.object.deep.merge(o.struct,a),a.json.keyword&&(o.item.keyword=a.json.keyword.split(",")),o.status.finish=!0)},show(){if(!o.status.finish)return a.warn("配置获取失败，无法进行配置！");o.status.dialog=!0},save:async()=>{o.status.wait=!0;const{code:e,msg:t}=await s.post("/api/config/save",{...o.struct,json:JSON.stringify(o.struct.json)});if(o.status.wait=!1,200!==e)return a.error("保存失败："+t);o.status.dialog=!1,l.del("site-info")},async upload(e="image"){const t=document.createElement("input");t.type="file",t.accept="image/*",t.addEventListener("change",(async()=>{const l=new FormData;l.append("file",t.files[0]),o.upload[e]=!0;const{code:n,msg:c,data:i}=await s.post("/api/file/upload",l);if(o.upload[e]=!1,200!==n)return a.error(c);o.struct.json[e]=i.path,t.value="",a.info("上传成功！")})),t.click()}};return d((()=>o.item.keyword),(e=>{o.struct.json.keyword=e?e.join(","):""})),n({init:c.init}),(e,s)=>{const a=m("i-svg"),t=m("el-tooltip"),l=m("i-lottie"),n=m("el-avatar"),i=m("el-input"),r=m("el-button"),u=m("el-option"),d=m("el-select"),_=m("el-date-picker"),C=m("el-dialog"),U=p("loading");return f(),g(z,null,[b((f(),g("div",{onClick:s[1]||(s[1]=e=>c.show()),class:"card pointer mb-3"},[h("div",wc,[y(a,{name:"site",color:"rgb(var(--assist-color))",size:"50px",class:"position-absolute opacity-25",style:{right:"2rem"}}),h("h6",xc,[y(t,{content:"（点击卡片配置）站点信息，如：备案号、头像、favicon、关键词和描述等",placement:"top"},{default:w((()=>[h("span",_c,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),kc])])),_:1})]),h("div",Vc,[h("span",zc,[y(l,{name:"avatar/crane",modelValue:v(o).item.avatar,"onUpdate:modelValue":s[0]||(s[0]=e=>v(o).item.avatar=e),width:"65px",height:"65px",class:"z-index-9"},null,8,["modelValue"]),y(n,{src:v(o).struct.json.avatar,size:52,style:{top:"7px",left:"2px"},class:"avatar-shadow position-absolute"},null,8,["src"])]),h("div",Sc,[h("span",jc,[h("span",Cc,j(v(o).struct.json.title),1)]),h("small",Uc,j(v(o).struct.json.description||"这个人很懒，什么都没留下！"),1)])])])])),[[U,v(o).status.loading]]),y(C,{modelValue:v(o).status.dialog,"onUpdate:modelValue":s[16]||(s[16]=e=>v(o).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[Oc])),default:w((()=>[h("div",qc,[h("div",Rc,[h("div",Kc,[h("label",Ic,[y(t,{content:"ICP备案码",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),Jc])])),_:1})]),y(i,{modelValue:v(o).struct.json.copy.code,"onUpdate:modelValue":s[2]||(s[2]=e=>v(o).struct.json.copy.code=e),placeholder:"ICP备案码"},null,8,["modelValue"])])]),h("div",Ac,[h("div",Nc,[h("label",Dc,[y(t,{content:"工信部网址，如：https://beian.miit.gov.cn",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),$c])])),_:1})]),y(i,{modelValue:v(o).struct.json.copy.link,"onUpdate:modelValue":s[3]||(s[3]=e=>v(o).struct.json.copy.link=e),placeholder:"如：https://beian.miit.gov.cn"},null,8,["modelValue"])])]),h("div",Ec,[h("div",Pc,[h("label",Tc,[y(t,{content:"公安备案码",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),Lc])])),_:1})]),y(i,{modelValue:v(o).struct.json.police.code,"onUpdate:modelValue":s[4]||(s[4]=e=>v(o).struct.json.police.code=e),placeholder:"公安备案码"},null,8,["modelValue"])])]),h("div",Mc,[h("div",Bc,[h("label",Wc,[y(t,{content:"公安备案网址，如：https://www.beian.gov.cn",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),Xc])])),_:1})]),y(i,{modelValue:v(o).struct.json.police.link,"onUpdate:modelValue":s[5]||(s[5]=e=>v(o).struct.json.police.link=e),placeholder:"如：https://www.beian.gov.cn"},null,8,["modelValue"])])]),h("div",Fc,[h("div",Hc,[h("label",Yc,[y(t,{content:"本站点的头像",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),Gc])])),_:1})]),y(i,{modelValue:v(o).struct.json.avatar,"onUpdate:modelValue":s[7]||(s[7]=e=>v(o).struct.json.avatar=e),class:"custom",placeholder:"填写图片地址或点击上传"},{suffix:w((()=>[y(r,{onClick:s[6]||(s[6]=e=>c.upload("avatar")),loading:v(o).upload.avatar},{default:w((()=>[v(o).upload.avatar?V("",!0):(f(),k(a,{key:0,name:"upload",color:"rgb(var(--icon-color))",size:"14px"})),Qc])),_:1},8,["loading"])])),_:1},8,["modelValue"])])]),h("div",Zc,[h("div",ei,[h("label",si,[y(t,{content:"本站点的小图标",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),ai])])),_:1})]),y(i,{modelValue:v(o).struct.json.favicon,"onUpdate:modelValue":s[9]||(s[9]=e=>v(o).struct.json.favicon=e),class:"custom",placeholder:"填写图片地址或点击上传"},{suffix:w((()=>[y(r,{onClick:s[8]||(s[8]=e=>c.upload("favicon")),loading:v(o).upload.favicon},{default:w((()=>[v(o).upload.favicon?V("",!0):(f(),k(a,{key:0,name:"upload",color:"rgb(var(--icon-color))",size:"14px"})),ti])),_:1},8,["loading"])])),_:1},8,["modelValue"])])]),h("div",li,[h("div",ni,[h("label",oi,[y(t,{content:"站点标题，如：米哈游",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),ci])])),_:1})]),y(i,{modelValue:v(o).struct.json.title,"onUpdate:modelValue":s[10]||(s[10]=e=>v(o).struct.json.title=e)},null,8,["modelValue"])])]),h("div",ii,[h("div",ri,[h("label",ui,[y(t,{content:"网站关键词，主要用于SEO场景，有助于收录",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),di])])),_:1})]),y(d,{modelValue:v(o).item.keyword,"onUpdate:modelValue":s[11]||(s[11]=e=>v(o).item.keyword=e),"reserve-keyword":!1,"default-first-option":"","collapse-tags-tooltip":"","allow-create":"",multiple:"",filterable:"","collapse-tags":"",class:"d-block custom font-13",placeholder:"请输入站点关键词"},{default:w((()=>[(f(!0),g(z,null,S(v(o).item.keyword,((e,s)=>(f(),k(u,{key:s,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),h("div",mi,[h("div",pi,[h("label",fi,[y(t,{content:"本网站运营的开始时间",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),gi])])),_:1})]),y(_,{modelValue:v(o).struct.json.date,"onUpdate:modelValue":s[12]||(s[12]=e=>v(o).struct.json.date=e),type:"date",format:"YYYY-MM-DD","value-format":"X",class:"d-block w-100 custom",placeholder:"请选择本站开设的时间"},null,8,["modelValue"])])])]),h("div",bi,[h("div",vi,[h("div",hi,[h("label",yi,[y(t,{content:"网站描述，主要用于SEO场景，有助于收录",placement:"top"},{default:w((()=>[h("span",null,[y(a,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),wi])])),_:1})]),y(i,{modelValue:v(o).struct.json.description,"onUpdate:modelValue":s[13]||(s[13]=e=>v(o).struct.json.description=e),autosize:{minRows:1,maxRows:10},placeholder:"站点描述！",type:"textarea"},null,8,["modelValue"])])])])])),footer:w((()=>[y(r,{onClick:s[14]||(s[14]=e=>v(o).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(r,{onClick:s[15]||(s[15]=e=>c.save()),loading:v(o).status.wait},{default:w((()=>[x("保 存")])),_:1},8,["loading"])])),_:1},8,["modelValue"])],64)}}},_i={class:"card"},ki={class:"card-body"},Vi={class:"text-muted text-uppercase mt-0"},zi=h("br",null,null,-1),Si=h("br",null,null,-1),ji={key:0},Ci={class:"d-inline-flex align-items-center"},Ui=h("span",{class:"ms-1"},"绑定 inis 社区账号",-1),Oi={class:"m-b-20"},qi=h("span",{class:"badge bg-success font-white"}," 更多 ",-1),Ri={class:"text-muted"},Ki={class:"d-flex flex-column align-items-center"},Ii={class:"flex-center"},Ji={class:"container-xxl"},Ai=h("br",null,null,-1),Ni=h("span",{class:"ms-1"},"绑定 inis 社区账号",-1),Di={class:"row mb-3 mt-3"},$i=h("label",{class:"col-3 col-form-label"},"帐号：",-1),Ei={class:"col-9"},Pi={class:"row mb-3"},Ti=h("label",{class:"col-3 col-form-label"},"密码：",-1),Li={class:"col-9 d-flex"},Mi=h("div",{class:"flex-center"},[h("a",{href:"https://inis.cc",target:"_blank",class:"text-dark"},"没有账号？去注册")],-1),Bi={class:"modal-footer d-flex justify-content-center"},Wi={__name:"bind",setup(e,{expose:l}){const o=r({struct:{account:null,password:null},status:{bind:!1,finish:!1,dialog:!1,loading:!0}}),c={init:async()=>{o.status.finish=!1,o.status.loading=!0;const{code:e,data:a}=await s.get("/inis/device/user");o.status.loading=!1,200===e&&(o.struct=a,o.status.bind=!0,o.status.finish=!0)},change:async e=>{if(e)return o.status.bind=e;const{code:t,msg:l}=await s.del("/inis/device/bind");return 200!==t?(o.status.bind=!0,a.error(l)):void 0},show(){o.status.dialog=!0},save:async()=>{if(t.is.empty(o.struct.account))return a.warn("请输入账号！");if(t.is.empty(o.struct.password))return a.warn("请输入密码！");o.status.wait=!0;const{code:e,msg:l}=await s.post("/inis/device/bind",o.struct);if(o.status.wait=!1,200!==e)return a.error(l);o.status.bind=!0,o.status.dialog=!1}};return u((async()=>{await c.init()})),l({init:c.init}),(e,s)=>{const a=m("el-image"),t=m("el-tooltip"),l=m("el-switch"),i=m("el-alert"),r=m("el-input"),u=m("el-button"),d=m("el-dialog"),k=p("loading");return f(),g(z,null,[b((f(),g("div",_i,[h("div",ki,[y(a,{src:"https://inis.cn/favicon.ico",class:"position-absolute opacity-25",style:{right:"1.5rem",height:"55px"}}),h("h6",Vi,[y(t,{placement:"top"},{content:w((()=>[x(" ● 程序后端许多功能都依赖于 inis 社区"),zi,x(" ● 绑定仅限于为您提供更好的服务体验，不涉及您的程序任何敏感信息，请放心使用"),Si,v(o).status.bind?(f(),g("span",ji,"● 当前绑定账号："+j(v(o).struct.account),1)):V("",!0)])),default:w((()=>[h("span",Ci,[y(n,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),Ui])])),_:1})]),h("h2",Oi,[y(l,{modelValue:v(o).status.bind,"onUpdate:modelValue":s[0]||(s[0]=e=>v(o).status.bind=e),onChange:c.change,disabled:!v(o).status.bind,"active-text":"绑定","inactive-text":"解绑"},null,8,["modelValue","onChange","disabled"])]),qi,h("span",Ri,[x(" 其它配置信息，"),h("span",{onClick:s[1]||(s[1]=e=>c.show()),class:"text-dark pointer"},"点我配置")])])])),[[k,v(o).status.loading]]),y(d,{modelValue:v(o).status.dialog,"onUpdate:modelValue":s[7]||(s[7]=e=>v(o).status.dialog=e),class:"custom sm","close-on-click-modal":!1},{header:w((()=>[h("div",Ki,[h("div",Ii,[y(a,{src:"https://inis.cn/assets/imgs/logo-white.png",style:{height:"52px"},class:"my-1 py-1"})])])])),default:w((()=>[h("div",Ji,[y(t,{placement:"top"},{content:w((()=>[x(" 程序后端许多功能都依赖于 inis 社区，绑定仅限于为您提供更好的服务体验，不涉及您的程序任何敏感信息，请放心使用。"),Ai])),default:w((()=>[y(i,{type:"success",closable:!1,center:"",class:"mb-3 box-shadow-light d-inline-flex align-items-center pointer"},{title:w((()=>[y(n,{name:"!",size:"15px",color:"var(--el-color-success)"}),Ni])),_:1})])),_:1}),h("div",Di,[$i,h("div",Ei,[y(r,{modelValue:v(o).struct.account,"onUpdate:modelValue":s[2]||(s[2]=e=>v(o).struct.account=e),class:"custom",placeholder:"帐号 | 邮箱 | 手机号"},null,8,["modelValue"])])]),h("div",Pi,[Ti,h("div",Li,[y(r,{modelValue:v(o).struct.password,"onUpdate:modelValue":s[3]||(s[3]=e=>v(o).struct.password=e),onKeyup:s[4]||(s[4]=_((e=>c.save()),["enter"])),"show-password":"",class:"custom",placeholder:"请输入密码"},null,8,["modelValue"])])]),Mi])])),footer:w((()=>[h("div",Bi,[y(u,{onClick:s[5]||(s[5]=e=>v(o).status.dialog=!1)},{default:w((()=>[x("取 消")])),_:1}),y(u,{onClick:s[6]||(s[6]=e=>c.save()),loading:v(o).status.wait},{default:w((()=>[x(j(v(o).status.wait?"绑定中 ...":"绑 定"),1)])),_:1},8,["loading"])])])),_:1},8,["modelValue"])],64)}}},Xi={class:"card mb-3"},Fi={class:"card-body"},Hi={class:"text-muted text-uppercase mt-0"},Yi=h("strong",{class:"text-success"},"默认主题也就是当前您看到的后台",-1),Gi=h("br",null,null,-1),Qi=h("br",null,null,-1),Zi={class:"d-inline-flex align-items-center"},er=h("span",{class:"ms-1"},"默认主题",-1),sr={class:"m-b-20"},ar=h("span",null,"检 查 更 新",-1),tr=h("span",null,"升 级",-1),lr=h("span",null,"日 志",-1),nr={class:"d-flex justify-content-between"},or=h("strong",{class:"flex-center"},"更新日志",-1),cr={key:0,class:"container-xxl"},ir={class:"d-flex justify-content-between align-items-center px-2 mb-2"},rr={class:"d-flex align-items-center pointer"},ur={class:"font-13 ms-1"},dr={class:"font-13"},mr={class:"el-alert el-alert--success is-light box-shadow-light d-flex justify-content-between"},pr={class:"d-flex align-items-center"},fr={key:0,class:"mt-2 markdown"},gr=["innerHTML"],br={key:1,class:"container-xxl"},vr=[h("div",{class:"el-alert el-alert--success is-light box-shadow-light flex-center"}," 无更新日志 ",-1)],hr={__name:"upgrade",setup(e,{expose:l}){const n=r({struct:{},status:{init:!0,finish:!1,dialog:!1,loading:!0,upgrade:!1},show:{upgrade:!1},version:inis.version}),o={init:async(e=!0)=>{n.status.init=e,n.status.loading=!0;const{code:a,data:t}=await s.get("/inis/theme-version/next",{theme_key:"inis",progress:"pro"});n.status.init=!1,n.status.loading=!1,200===a&&(n.struct=t)},upgrade:async()=>{var e;n.status.upgrade=!0;const{code:t,msg:l}=await s.post("/api/upgrade/theme",{id:null==(e=n.struct)?void 0:e.id});n.status.upgrade=!1,200!==t&&a.error(l),a.success("升级成功！"),await o.init(!1)},show(){n.status.dialog=!0},markdown:e=>(new A).render(e),color:e=>{switch(e){case"design":return{color:"var(--bs-secondary)",text:"设计中"};case"dev":return{color:"var(--bs-primary)",text:"开发版"};case"test":return{color:"var(--bs-warning)",text:"测试版"};case"pro":return{color:"var(--bs-success)",text:"正式版"};case"abandon":return{color:"var(--bs-danger)",text:"停止维护"};default:return{color:"var(--bs-light)",text:"未知"}}}};return u((async()=>{await o.init()})),d((()=>n.struct),((e={})=>{n.show.upgrade=t.compare.version(e.version,n.version)})),l({init:o.init}),(e,s)=>{const a=m("i-svg"),l=m("el-tooltip"),c=m("el-button"),i=m("el-avatar"),r=m("el-scrollbar"),u=m("el-dialog"),d=p("loading");return f(),g(z,null,[b((f(),g("div",Xi,[h("div",Fi,[y(a,{name:"upgrade",size:"50px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),h("h6",Hi,[y(l,{placement:"top"},{content:w((()=>[Yi,Gi,x(" ● 默认主题一般情况下是自动升级的，在超级管理员权限下检查到新版本会自动升级"),Qi,x(" ● 自动升级检查10分钟会检查一次，也可以通过当前卡片的功能手动检查并进行升级 ")])),default:w((()=>[h("span",Zi,[y(a,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),er])])),_:1})]),h("h2",sr,[y(c,{onClick:s[0]||(s[0]=e=>o.init(!1)),loading:v(n).status.loading,type:"primary",size:"small",round:"",plain:"",style:{margin:"4px 0"}},{default:w((()=>[ar])),_:1},8,["loading"]),v(n).show.upgrade?(f(),k(c,{key:0,onClick:o.upgrade,loading:v(n).status.upgrade,type:"primary",size:"small",round:"",plain:"",class:"ms-2",style:{margin:"4px 0"}},{default:w((()=>[tr])),_:1},8,["onClick","loading"])):V("",!0),y(c,{onClick:o.show,type:"primary",size:"small",round:"",class:"ms-2",style:{margin:"4px 0"}},{default:w((()=>[lr])),_:1},8,["onClick"])]),h("div",nr,[h("span",null,"当前版本："+j(v(n).version),1),h("span",null,"最新版本："+j(v(n).struct.version||"∞"),1)])])])),[[d,v(n).status.init]]),y(u,{modelValue:v(n).status.dialog,"onUpdate:modelValue":s[2]||(s[2]=e=>v(n).status.dialog=e),class:"custom",draggable:"","close-on-click-modal":!1},{header:w((()=>[or])),default:w((()=>{var e,s,c,u,d;return[v(t).is.empty(v(n).struct)?(f(),g("div",br,vr)):(f(),g("div",cr,[h("div",ir,[y(l,{content:`${null==(s=null==(e=v(n).struct.result)?void 0:e.author)?void 0:s.nickname}：${null==(u=null==(c=v(n).struct.result)?void 0:c.author)?void 0:u.description}`,placement:"top"},{default:w((()=>{var e,s,a,t;return[h("div",rr,[y(i,{src:null==(s=null==(e=v(n).struct.result)?void 0:e.author)?void 0:s.avatar,size:25,class:"avatar-shadow mirror-scan"},null,8,["src"]),h("span",ur,j(null==(t=null==(a=v(n).struct.result)?void 0:a.author)?void 0:t.nickname),1)])]})),_:1},8,["content"]),h("span",dr,"时间："+j(v(t).time.to.date(null==(d=v(n).struct)?void 0:d.create_time)),1)]),h("div",mr,[h("span",null,j(v(n).struct.title),1),h("span",pr,[y(a,{name:"dot",color:o.color(v(n).struct.progress).color,size:"20px"},null,8,["color"]),x(" "+j(o.color(v(n).struct.progress).text)+"："+j(v(n).struct.version),1)])]),v(t).is.empty(v(n).struct.content)?V("",!0):(f(),g("div",fr,[y(r,{"max-height":"400px"},{default:w((()=>[h("div",{innerHTML:o.markdown(v(n).struct.content),class:"white-space-line"},null,8,gr)])),_:1})]))]))]})),footer:w((()=>[y(c,{onClick:s[1]||(s[1]=e=>v(n).status.dialog=!1)},{default:w((()=>[x(" 取 消 ")])),_:1})])),_:1},8,["modelValue"])],64)}}},yr={class:"container-fluid container-box"},wr={class:"row d-none d-lg-flex"},xr={class:"col-lg-6 d-flex"},_r={class:"input-group custom-search me-1"},kr=h("input",{class:"form-control custom search mimic",autocomplete:"new-password",type:"text",placeholder:"这是个假搜索"},null,-1),Vr={class:"col-lg-6 d-flex justify-content-end",style:{"z-index":"-1"}},zr={class:"btn btn-auto h-35px mimic",disabled:"",type:"button"},Sr={class:"row mt-3"},jr={class:"col-12"},Cr=h("span",{class:"fw-bolder font-12"},"安全",-1),Ur={class:"row"},Or={class:"col-md-4"},qr={class:"col-md-4"},Rr={class:"col-md-4"},Kr={class:"col-md-4"},Ir={class:"col-md-4"},Jr={class:"col-md-4"},Ar=h("span",{class:"fw-bolder font-12"},"优化",-1),Nr={class:"row"},Dr={class:"col-md-4"},$r={class:"col-md-4"},Er={class:"col-md-4"},Pr=h("span",{class:"fw-bolder font-12"},"存储",-1),Tr={class:"row"},Lr={class:"col-md-4"},Mr={class:"col-md-4"},Br={class:"col-md-4"},Wr={class:"col-md-4"},Xr=h("span",{class:"fw-bolder font-12"},"短信",-1),Fr={class:"row"},Hr={class:"col-md-4"},Yr={class:"col-md-4"},Gr={class:"col-md-4"},Qr=h("span",{class:"fw-bolder font-12"},"其他",-1),Zr={class:"row"},eu={class:"col-md-4"},su={class:"col-md-4"},au={class:"col-md-4"},tu=h("span",{class:"fw-bolder font-12"},"inis",-1),lu={class:"row"},nu={class:"col-md-4"},ou={class:"col-md-4"},cu={__name:"system",setup(s){const{ctx:a,proxy:t}=U();o();const l=r({item:{title:"系统配置",tabs:"security",menu:{...c,menuList:[{label:"刷新",icon:'<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="14" height="14">\n                    <path fill="rgb(var(--menu-icon-color))" d="M608 928c-229.76 0-416-186.24-416-416h-0.128c0-0.416 0.128-0.768 0.128-1.184a95.904 95.904 0 1 0-191.872-1.184c0 0.384-0.128 0.768-0.128 1.184l0.032 0.384c0 0.288 0.096 0.544 0.096 0.8H0c0 282.784 229.216 512 512 512 282.016 0 510.592-227.968 511.872-509.632C1022.592 743.072 836.928 928 608 928z"></path>\n                    <path fill="rgb(var(--menu-icon-color))" d="M1023.872 512H1024c0-282.784-229.216-512-512-512C230.016 0 1.408 227.968 0.128 509.632 1.408 280.96 187.072 96 416 96c229.76 0 416 186.24 416 416h0.128c0 0.416-0.128 0.768-0.128 1.184a96 96 0 0 0 96 96 95.872 95.872 0 0 0 95.872-94.816c0-0.416 0.128-0.768 0.128-1.184l-0.032-0.384c0-0.288-0.096-0.544-0.096-0.8z"></path>\n                </svg>',fn:()=>n.refresh()}]}},refresh:{inis:["device-bind","upgrade"],other:["site-info","page","article"],optimize:["cache-redis","cache-file","cache-ram"],sms:["sms-email","sms-aliyun","sms-tencent"],storage:["storage-local","storage-oss","storage-cos","storage-kodo"],security:["api-key","qps","page-limit","jwt","allow-register","qps-black"]}});u((async()=>{l.item.menu.menuList.push({line:!0},...await i())}));const n={refresh(...e){let s=[...l.refresh[l.item.tabs]];e=0===e.length?s:e.filter((e=>s.includes(e)));for(let a of e)t.$refs[a].init()}};return document.addEventListener("contextmenu",(e=>{var s;e.preventDefault(),null==(s=t.$refs.mouse)||s.show(e.x,e.y)})),(s,a)=>{const t=m("i-svg"),o=m("el-tab-pane"),c=m("el-tabs");return f(),g(z,null,[h("div",yr,[h("div",wr,[h("div",xr,[h("div",_r,[y(t,{name:"search",color:"rgb(var(--icon-color))",size:"18px"}),kr]),h("button",{onClick:a[0]||(a[0]=e=>n.refresh()),class:"btn btn-auto mx-1 mimic",type:"button"},"刷新")]),h("div",Vr,[h("button",zr,j(v(l).item.title),1)])]),h("div",Sr,[h("div",jr,[y(c,{modelValue:v(l).item.tabs,"onUpdate:modelValue":a[1]||(a[1]=e=>v(l).item.tabs=e),id:"tabs-area",class:"circle"},{default:w((()=>[y(o,{name:"security"},{label:w((()=>[Cr])),default:w((()=>[h("div",Ur,[h("div",Or,[y(O,{ref:"api-key"},null,512)]),h("div",qr,[y(q,{ref:"qps"},null,512)]),h("div",Rr,[y(K,{ref:"qps-black"},null,512)]),h("div",Kr,[y(R,{ref:"page-limit"},null,512)]),h("div",Ir,[y(ct,{ref:"jwt"},null,512)]),h("div",Jr,[y(Ra,{ref:"allow-register"},null,512)])])])),_:1}),y(o,{name:"optimize"},{label:w((()=>[Ar])),default:w((()=>[h("div",Nr,[h("div",Dr,[y(Ht,{ref:"cache-redis",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",$r,[y(kl,{ref:"cache-file",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",Er,[y(Tl,{ref:"cache-ram",onRefresh:n.refresh},null,8,["onRefresh"])])])])),_:1}),y(o,{name:"storage"},{label:w((()=>[Pr])),default:w((()=>[h("div",Tr,[h("div",Lr,[y(rn,{ref:"storage-local",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",Mr,[y(Fn,{ref:"storage-oss",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",Br,[y(Do,{ref:"storage-cos",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",Wr,[y(yc,{ref:"storage-kodo",onRefresh:n.refresh},null,8,["onRefresh"])])])])),_:1}),y(o,{name:"sms"},{label:w((()=>[Xr])),default:w((()=>[h("div",Fr,[h("div",Hr,[y(ze,{ref:"sms-email",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",Yr,[y(us,{ref:"sms-aliyun",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",Gr,[y(ta,{ref:"sms-tencent",onRefresh:n.refresh},null,8,["onRefresh"])])])])),_:1}),y(o,{name:"other"},{label:w((()=>[Qr])),default:w((()=>[h("div",Zr,[h("div",eu,[y(I,{ref:"page",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",su,[y(J,{ref:"article",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",au,[y(xi,{ref:"site-info",onRefresh:n.refresh},null,8,["onRefresh"])])])])),_:1}),y(o,{name:"inis"},{label:w((()=>[tu])),default:w((()=>[h("div",lu,[h("div",nu,[y(hr,{ref:"upgrade",onRefresh:n.refresh},null,8,["onRefresh"])]),h("div",ou,[y(Wi,{ref:"device-bind",onRefresh:n.refresh},null,8,["onRefresh"])])])])),_:1})])),_:1},8,["modelValue"])])])]),y(v(e),C({ref:"mouse"},v(l).item.menu),null,16)],64)}}};export{cu as default};
